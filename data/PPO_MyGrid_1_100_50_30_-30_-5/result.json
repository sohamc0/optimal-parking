{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.245082279270694, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 187.33632126674857, "policy_loss": -0.01834484135872254, "vf_loss": 187.35078648392872, "vf_explained_var": 0.012086209622762537, "kl": 0.019395982912647165, "entropy": 1.366942911378799, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 55.0, "episode_reward_min": -197.0, "episode_reward_mean": -31.123655913978496, "episode_len_mean": 21.446236559139784, "episode_media": {}, "episodes_this_iter": 186, "episodes_timesteps_total": 3989, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-86.0, -32.0, -57.0, -46.0, -70.0, -43.0, 39.0, 19.0, 15.0, -39.0, -22.0, -31.0, -116.0, 45.0, -39.0, -38.0, -43.0, -29.0, -34.0, -14.0, -87.0, 21.0, -49.0, -74.0, -28.0, -66.0, -46.0, -43.0, 25.0, -60.0, -81.0, 23.0, 55.0, -55.0, 21.0, -32.0, 13.0, -68.0, -39.0, 34.0, -70.0, -42.0, -56.0, -36.0, 15.0, -49.0, 9.0, -139.0, -52.0, -70.0, 23.0, -90.0, -67.0, -56.0, -8.0, -53.0, -46.0, -99.0, 44.0, -25.0, 17.0, -72.0, -117.0, -30.0, -40.0, -40.0, 27.0, -197.0, -33.0, -32.0, -30.0, 20.0, 7.0, -39.0, -59.0, -21.0, -32.0, -41.0, 38.0, 50.0, -48.0, -53.0, -43.0, -29.0, -39.0, 21.0, -41.0, -44.0, -41.0, -30.0, -35.0, -37.0, -37.0, -39.0, 23.0, -36.0, -95.0, 21.0, -35.0, -69.0, -46.0, 27.0, -38.0, -9.0, 50.0, 42.0, -46.0, -37.0, -29.0, -33.0, -53.0, -36.0, -95.0, -31.0, -50.0, -118.0, -59.0, -28.0, -43.0, -33.0, -51.0, 4.0, -33.0, -39.0, 30.0, -50.0, -43.0, -119.0, -2.0, 43.0, -56.0, 39.0, -39.0, -37.0, 14.0, 21.0, -52.0, -33.0, -14.0, 42.0, -140.0, -56.0, -55.0, -31.0, -39.0, -48.0, 21.0, -46.0, -38.0, -37.0, -35.0, 21.0, -93.0, -55.0, 12.0, -34.0, -62.0, -33.0, -50.0, -32.0, 35.0, 53.0, -18.0, -43.0, -39.0, -23.0, 19.0, -34.0, 29.0, -34.0, 35.0, -67.0, -56.0, 13.0, -57.0, -13.0, -80.0, 55.0, -69.0, -44.0, -63.0, -41.0, 23.0, -21.0, -65.0, -80.0], "episode_lengths": [23, 11, 10, 27, 39, 18, 10, 8, 26, 4, 63, 6, 35, 16, 4, 5, 18, 8, 15, 47, 64, 4, 12, 59, 9, 19, 9, 6, 14, 31, 52, 6, 12, 36, 10, 17, 8, 83, 4, 9, 27, 7, 23, 7, 34, 6, 10, 54, 21, 21, 12, 25, 66, 11, 29, 8, 9, 28, 7, 30, 6, 25, 106, 13, 9, 57, 4, 56, 16, 17, 7, 9, 44, 4, 38, 40, 23, 8, 63, 13, 37, 8, 6, 14, 22, 4, 26, 11, 14, 13, 20, 6, 6, 4, 6, 7, 26, 4, 8, 16, 9, 10, 17, 58, 21, 11, 15, 12, 44, 28, 26, 19, 50, 90, 59, 57, 32, 9, 24, 4, 22, 27, 4, 28, 7, 23, 12, 32, 23, 60, 11, 8, 4, 12, 21, 10, 15, 10, 29, 5, 65, 11, 12, 24, 4, 43, 4, 15, 17, 12, 8, 20, 34, 30, 23, 9, 23, 10, 29, 11, 24, 36, 37, 12, 4, 26, 8, 21, 6, 15, 36, 24, 29, 8, 28, 18, 17, 12, 40, 17, 16, 14, 6, 22, 14, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26798349593586096, "mean_inference_ms": 1.7249272543619472, "mean_action_processing_ms": 0.09319651755533408, "mean_env_wait_ms": 0.18200562078337226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019655689116447203, "StateBufferConnector_ms": 0.004811440744707661, "ViewRequirementAgentConnector_ms": 0.087437193880799}, "num_episodes": 186, "episode_return_max": 55.0, "episode_return_min": -197.0, "episode_return_mean": -31.123655913978496}, "env_runner_results": {"episode_reward_max": 55.0, "episode_reward_min": -197.0, "episode_reward_mean": -31.123655913978496, "episode_len_mean": 21.446236559139784, "episode_media": {}, "episodes_this_iter": 186, "episodes_timesteps_total": 3989, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-86.0, -32.0, -57.0, -46.0, -70.0, -43.0, 39.0, 19.0, 15.0, -39.0, -22.0, -31.0, -116.0, 45.0, -39.0, -38.0, -43.0, -29.0, -34.0, -14.0, -87.0, 21.0, -49.0, -74.0, -28.0, -66.0, -46.0, -43.0, 25.0, -60.0, -81.0, 23.0, 55.0, -55.0, 21.0, -32.0, 13.0, -68.0, -39.0, 34.0, -70.0, -42.0, -56.0, -36.0, 15.0, -49.0, 9.0, -139.0, -52.0, -70.0, 23.0, -90.0, -67.0, -56.0, -8.0, -53.0, -46.0, -99.0, 44.0, -25.0, 17.0, -72.0, -117.0, -30.0, -40.0, -40.0, 27.0, -197.0, -33.0, -32.0, -30.0, 20.0, 7.0, -39.0, -59.0, -21.0, -32.0, -41.0, 38.0, 50.0, -48.0, -53.0, -43.0, -29.0, -39.0, 21.0, -41.0, -44.0, -41.0, -30.0, -35.0, -37.0, -37.0, -39.0, 23.0, -36.0, -95.0, 21.0, -35.0, -69.0, -46.0, 27.0, -38.0, -9.0, 50.0, 42.0, -46.0, -37.0, -29.0, -33.0, -53.0, -36.0, -95.0, -31.0, -50.0, -118.0, -59.0, -28.0, -43.0, -33.0, -51.0, 4.0, -33.0, -39.0, 30.0, -50.0, -43.0, -119.0, -2.0, 43.0, -56.0, 39.0, -39.0, -37.0, 14.0, 21.0, -52.0, -33.0, -14.0, 42.0, -140.0, -56.0, -55.0, -31.0, -39.0, -48.0, 21.0, -46.0, -38.0, -37.0, -35.0, 21.0, -93.0, -55.0, 12.0, -34.0, -62.0, -33.0, -50.0, -32.0, 35.0, 53.0, -18.0, -43.0, -39.0, -23.0, 19.0, -34.0, 29.0, -34.0, 35.0, -67.0, -56.0, 13.0, -57.0, -13.0, -80.0, 55.0, -69.0, -44.0, -63.0, -41.0, 23.0, -21.0, -65.0, -80.0], "episode_lengths": [23, 11, 10, 27, 39, 18, 10, 8, 26, 4, 63, 6, 35, 16, 4, 5, 18, 8, 15, 47, 64, 4, 12, 59, 9, 19, 9, 6, 14, 31, 52, 6, 12, 36, 10, 17, 8, 83, 4, 9, 27, 7, 23, 7, 34, 6, 10, 54, 21, 21, 12, 25, 66, 11, 29, 8, 9, 28, 7, 30, 6, 25, 106, 13, 9, 57, 4, 56, 16, 17, 7, 9, 44, 4, 38, 40, 23, 8, 63, 13, 37, 8, 6, 14, 22, 4, 26, 11, 14, 13, 20, 6, 6, 4, 6, 7, 26, 4, 8, 16, 9, 10, 17, 58, 21, 11, 15, 12, 44, 28, 26, 19, 50, 90, 59, 57, 32, 9, 24, 4, 22, 27, 4, 28, 7, 23, 12, 32, 23, 60, 11, 8, 4, 12, 21, 10, 15, 10, 29, 5, 65, 11, 12, 24, 4, 43, 4, 15, 17, 12, 8, 20, 34, 30, 23, 9, 23, 10, 29, 11, 24, 36, 37, 12, 4, 26, 8, 21, 6, 15, 36, 24, 29, 8, 28, 18, 17, 12, 40, 17, 16, 14, 6, 22, 14, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26798349593586096, "mean_inference_ms": 1.7249272543619472, "mean_action_processing_ms": 0.09319651755533408, "mean_env_wait_ms": 0.18200562078337226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019655689116447203, "StateBufferConnector_ms": 0.004811440744707661, "ViewRequirementAgentConnector_ms": 0.087437193880799}, "num_episodes": 186, "episode_return_max": 55.0, "episode_return_min": -197.0, "episode_return_mean": -31.123655913978496}, "episode_reward_max": 55.0, "episode_reward_min": -197.0, "episode_reward_mean": -31.123655913978496, "episode_len_mean": 21.446236559139784, "episodes_this_iter": 186, "episodes_timesteps_total": 3989, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-86.0, -32.0, -57.0, -46.0, -70.0, -43.0, 39.0, 19.0, 15.0, -39.0, -22.0, -31.0, -116.0, 45.0, -39.0, -38.0, -43.0, -29.0, -34.0, -14.0, -87.0, 21.0, -49.0, -74.0, -28.0, -66.0, -46.0, -43.0, 25.0, -60.0, -81.0, 23.0, 55.0, -55.0, 21.0, -32.0, 13.0, -68.0, -39.0, 34.0, -70.0, -42.0, -56.0, -36.0, 15.0, -49.0, 9.0, -139.0, -52.0, -70.0, 23.0, -90.0, -67.0, -56.0, -8.0, -53.0, -46.0, -99.0, 44.0, -25.0, 17.0, -72.0, -117.0, -30.0, -40.0, -40.0, 27.0, -197.0, -33.0, -32.0, -30.0, 20.0, 7.0, -39.0, -59.0, -21.0, -32.0, -41.0, 38.0, 50.0, -48.0, -53.0, -43.0, -29.0, -39.0, 21.0, -41.0, -44.0, -41.0, -30.0, -35.0, -37.0, -37.0, -39.0, 23.0, -36.0, -95.0, 21.0, -35.0, -69.0, -46.0, 27.0, -38.0, -9.0, 50.0, 42.0, -46.0, -37.0, -29.0, -33.0, -53.0, -36.0, -95.0, -31.0, -50.0, -118.0, -59.0, -28.0, -43.0, -33.0, -51.0, 4.0, -33.0, -39.0, 30.0, -50.0, -43.0, -119.0, -2.0, 43.0, -56.0, 39.0, -39.0, -37.0, 14.0, 21.0, -52.0, -33.0, -14.0, 42.0, -140.0, -56.0, -55.0, -31.0, -39.0, -48.0, 21.0, -46.0, -38.0, -37.0, -35.0, 21.0, -93.0, -55.0, 12.0, -34.0, -62.0, -33.0, -50.0, -32.0, 35.0, 53.0, -18.0, -43.0, -39.0, -23.0, 19.0, -34.0, 29.0, -34.0, 35.0, -67.0, -56.0, 13.0, -57.0, -13.0, -80.0, 55.0, -69.0, -44.0, -63.0, -41.0, 23.0, -21.0, -65.0, -80.0], "episode_lengths": [23, 11, 10, 27, 39, 18, 10, 8, 26, 4, 63, 6, 35, 16, 4, 5, 18, 8, 15, 47, 64, 4, 12, 59, 9, 19, 9, 6, 14, 31, 52, 6, 12, 36, 10, 17, 8, 83, 4, 9, 27, 7, 23, 7, 34, 6, 10, 54, 21, 21, 12, 25, 66, 11, 29, 8, 9, 28, 7, 30, 6, 25, 106, 13, 9, 57, 4, 56, 16, 17, 7, 9, 44, 4, 38, 40, 23, 8, 63, 13, 37, 8, 6, 14, 22, 4, 26, 11, 14, 13, 20, 6, 6, 4, 6, 7, 26, 4, 8, 16, 9, 10, 17, 58, 21, 11, 15, 12, 44, 28, 26, 19, 50, 90, 59, 57, 32, 9, 24, 4, 22, 27, 4, 28, 7, 23, 12, 32, 23, 60, 11, 8, 4, 12, 21, 10, 15, 10, 29, 5, 65, 11, 12, 24, 4, 43, 4, 15, 17, 12, 8, 20, 34, 30, 23, 9, 23, 10, 29, 11, 24, 36, 37, 12, 4, 26, 8, 21, 6, 15, 36, 24, 29, 8, 28, 18, 17, 12, 40, 17, 16, 14, 6, 22, 14, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26798349593586096, "mean_inference_ms": 1.7249272543619472, "mean_action_processing_ms": 0.09319651755533408, "mean_env_wait_ms": 0.18200562078337226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019655689116447203, "StateBufferConnector_ms": 0.004811440744707661, "ViewRequirementAgentConnector_ms": 0.087437193880799}, "num_episodes": 186, "episode_return_max": 55.0, "episode_return_min": -197.0, "episode_return_mean": -31.123655913978496, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.13236443123475, "num_env_steps_trained_throughput_per_sec": 226.13236443123475, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 17688.772, "restore_workers_time_ms": 0.022, "training_step_time_ms": 17688.7, "sample_time_ms": 9127.245, "load_time_ms": 0.519, "load_throughput": 7706576.022, "learn_time_ms": 8551.931, "learn_throughput": 467.731, "synch_weights_time_ms": 8.199}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 186, "training_iteration": 1, "trial_id": "default", "date": "2024-05-20_21-22-56", "timestamp": 1716265376, "time_this_iter_s": 17.70736312866211, "time_total_s": 17.70736312866211, "pid": 2798, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147c08220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 200.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 17.70736312866211, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.67692307692308, "ram_util_percent": 56.892307692307696}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.433415289655805, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 167.82485719906387, "policy_loss": 0.004085649334655333, "vf_loss": 167.8172453275291, "vf_explained_var": -0.01460433942015453, "kl": 0.01763160069838087, "entropy": 1.3351027355399183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 93.0, "episode_reward_min": -111.0, "episode_reward_mean": -12.868421052631579, "episode_len_mean": 34.324561403508774, "episode_media": {}, "episodes_this_iter": 114, "episodes_timesteps_total": 3913, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 11.0, -18.0, 6.0, 92.0, 35.0, 20.0, 6.0, -63.0, -26.0, -63.0, 23.0, -60.0, -52.0, -33.0, -76.0, -52.0, -40.0, -47.0, -69.0, -32.0, -24.0, -32.0, -17.0, -8.0, 93.0, -34.0, 21.0, -30.0, -18.0, 34.0, 34.0, -37.0, 41.0, -18.0, 48.0, -45.0, -20.0, -96.0, -41.0, 45.0, -88.0, -44.0, -3.0, 45.0, -15.0, -42.0, 16.0, -12.0, -27.0, -8.0, 22.0, -37.0, -29.0, -23.0, -49.0, -36.0, 60.0, -13.0, -11.0, -102.0, -37.0, 29.0, -46.0, -7.0, 9.0, 7.0, -59.0, 33.0, -46.0, -31.0, -24.0, 20.0, 46.0, 72.0, -43.0, -87.0, -31.0, 21.0, -79.0, 21.0, 31.0, 18.0, -111.0, -66.0, -20.0, 49.0, 37.0, 36.0, 17.0, -37.0, 48.0, -6.0, -26.0, -63.0, -22.0, -31.0, 31.0, -50.0, -16.0, -33.0, -38.0, -20.0, 33.0, -22.0, -62.0, 33.0, -70.0, -25.0, 31.0, -42.0, 8.0, 52.0, 4.0], "episode_lengths": [12, 6, 61, 25, 53, 12, 15, 19, 10, 17, 58, 18, 25, 27, 4, 33, 15, 9, 74, 46, 17, 19, 5, 26, 47, 50, 9, 4, 19, 49, 35, 33, 12, 54, 19, 31, 46, 11, 37, 20, 16, 57, 11, 40, 8, 64, 25, 23, 49, 28, 101, 5, 6, 14, 14, 6, 37, 57, 18, 44, 247, 12, 24, 39, 30, 172, 14, 26, 10, 9, 30, 19, 57, 63, 97, 18, 28, 6, 4, 66, 10, 20, 25, 100, 25, 17, 32, 60, 7, 66, 30, 31, 61, 17, 40, 51, 24, 68, 35, 21, 10, 5, 35, 16, 21, 47, 26, 33, 12, 194, 13, 15, 41, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25325643317488744, "mean_inference_ms": 1.6640533940253623, "mean_action_processing_ms": 0.0895203210282156, "mean_env_wait_ms": 0.18199576897675393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01855084770604184, "StateBufferConnector_ms": 0.0040075235199510005, "ViewRequirementAgentConnector_ms": 0.0809613027070698}, "num_episodes": 114, "episode_return_max": 93.0, "episode_return_min": -111.0, "episode_return_mean": -12.868421052631579}, "env_runner_results": {"episode_reward_max": 93.0, "episode_reward_min": -111.0, "episode_reward_mean": -12.868421052631579, "episode_len_mean": 34.324561403508774, "episode_media": {}, "episodes_this_iter": 114, "episodes_timesteps_total": 3913, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 11.0, -18.0, 6.0, 92.0, 35.0, 20.0, 6.0, -63.0, -26.0, -63.0, 23.0, -60.0, -52.0, -33.0, -76.0, -52.0, -40.0, -47.0, -69.0, -32.0, -24.0, -32.0, -17.0, -8.0, 93.0, -34.0, 21.0, -30.0, -18.0, 34.0, 34.0, -37.0, 41.0, -18.0, 48.0, -45.0, -20.0, -96.0, -41.0, 45.0, -88.0, -44.0, -3.0, 45.0, -15.0, -42.0, 16.0, -12.0, -27.0, -8.0, 22.0, -37.0, -29.0, -23.0, -49.0, -36.0, 60.0, -13.0, -11.0, -102.0, -37.0, 29.0, -46.0, -7.0, 9.0, 7.0, -59.0, 33.0, -46.0, -31.0, -24.0, 20.0, 46.0, 72.0, -43.0, -87.0, -31.0, 21.0, -79.0, 21.0, 31.0, 18.0, -111.0, -66.0, -20.0, 49.0, 37.0, 36.0, 17.0, -37.0, 48.0, -6.0, -26.0, -63.0, -22.0, -31.0, 31.0, -50.0, -16.0, -33.0, -38.0, -20.0, 33.0, -22.0, -62.0, 33.0, -70.0, -25.0, 31.0, -42.0, 8.0, 52.0, 4.0], "episode_lengths": [12, 6, 61, 25, 53, 12, 15, 19, 10, 17, 58, 18, 25, 27, 4, 33, 15, 9, 74, 46, 17, 19, 5, 26, 47, 50, 9, 4, 19, 49, 35, 33, 12, 54, 19, 31, 46, 11, 37, 20, 16, 57, 11, 40, 8, 64, 25, 23, 49, 28, 101, 5, 6, 14, 14, 6, 37, 57, 18, 44, 247, 12, 24, 39, 30, 172, 14, 26, 10, 9, 30, 19, 57, 63, 97, 18, 28, 6, 4, 66, 10, 20, 25, 100, 25, 17, 32, 60, 7, 66, 30, 31, 61, 17, 40, 51, 24, 68, 35, 21, 10, 5, 35, 16, 21, 47, 26, 33, 12, 194, 13, 15, 41, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25325643317488744, "mean_inference_ms": 1.6640533940253623, "mean_action_processing_ms": 0.0895203210282156, "mean_env_wait_ms": 0.18199576897675393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01855084770604184, "StateBufferConnector_ms": 0.0040075235199510005, "ViewRequirementAgentConnector_ms": 0.0809613027070698}, "num_episodes": 114, "episode_return_max": 93.0, "episode_return_min": -111.0, "episode_return_mean": -12.868421052631579}, "episode_reward_max": 93.0, "episode_reward_min": -111.0, "episode_reward_mean": -12.868421052631579, "episode_len_mean": 34.324561403508774, "episodes_this_iter": 114, "episodes_timesteps_total": 3913, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.0, 11.0, -18.0, 6.0, 92.0, 35.0, 20.0, 6.0, -63.0, -26.0, -63.0, 23.0, -60.0, -52.0, -33.0, -76.0, -52.0, -40.0, -47.0, -69.0, -32.0, -24.0, -32.0, -17.0, -8.0, 93.0, -34.0, 21.0, -30.0, -18.0, 34.0, 34.0, -37.0, 41.0, -18.0, 48.0, -45.0, -20.0, -96.0, -41.0, 45.0, -88.0, -44.0, -3.0, 45.0, -15.0, -42.0, 16.0, -12.0, -27.0, -8.0, 22.0, -37.0, -29.0, -23.0, -49.0, -36.0, 60.0, -13.0, -11.0, -102.0, -37.0, 29.0, -46.0, -7.0, 9.0, 7.0, -59.0, 33.0, -46.0, -31.0, -24.0, 20.0, 46.0, 72.0, -43.0, -87.0, -31.0, 21.0, -79.0, 21.0, 31.0, 18.0, -111.0, -66.0, -20.0, 49.0, 37.0, 36.0, 17.0, -37.0, 48.0, -6.0, -26.0, -63.0, -22.0, -31.0, 31.0, -50.0, -16.0, -33.0, -38.0, -20.0, 33.0, -22.0, -62.0, 33.0, -70.0, -25.0, 31.0, -42.0, 8.0, 52.0, 4.0], "episode_lengths": [12, 6, 61, 25, 53, 12, 15, 19, 10, 17, 58, 18, 25, 27, 4, 33, 15, 9, 74, 46, 17, 19, 5, 26, 47, 50, 9, 4, 19, 49, 35, 33, 12, 54, 19, 31, 46, 11, 37, 20, 16, 57, 11, 40, 8, 64, 25, 23, 49, 28, 101, 5, 6, 14, 14, 6, 37, 57, 18, 44, 247, 12, 24, 39, 30, 172, 14, 26, 10, 9, 30, 19, 57, 63, 97, 18, 28, 6, 4, 66, 10, 20, 25, 100, 25, 17, 32, 60, 7, 66, 30, 31, 61, 17, 40, 51, 24, 68, 35, 21, 10, 5, 35, 16, 21, 47, 26, 33, 12, 194, 13, 15, 41, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25325643317488744, "mean_inference_ms": 1.6640533940253623, "mean_action_processing_ms": 0.0895203210282156, "mean_env_wait_ms": 0.18199576897675393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01855084770604184, "StateBufferConnector_ms": 0.0040075235199510005, "ViewRequirementAgentConnector_ms": 0.0809613027070698}, "num_episodes": 114, "episode_return_max": 93.0, "episode_return_min": -111.0, "episode_return_mean": -12.868421052631579, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.80708504831597, "num_env_steps_trained_throughput_per_sec": 240.80708504831597, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 17149.794, "restore_workers_time_ms": 0.018, "training_step_time_ms": 17149.735, "sample_time_ms": 8803.951, "load_time_ms": 0.41, "load_throughput": 9754195.349, "learn_time_ms": 8337.118, "learn_throughput": 479.782, "synch_weights_time_ms": 7.625}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 300, "training_iteration": 2, "trial_id": "default", "date": "2024-05-20_21-23-13", "timestamp": 1716265393, "time_this_iter_s": 16.61905527114868, "time_total_s": 34.32641839981079, "pid": 2798, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147c08220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 200.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 34.32641839981079, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.67391304347827, "ram_util_percent": 56.986956521739145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 64.2552469127441, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 167.79550872310514, "policy_loss": -0.017129339786216377, "vf_loss": 167.80871347406858, "vf_explained_var": -0.02831399216446825, "kl": 0.019623523032038095, "entropy": 1.2986610135724468, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 78.0, "episode_reward_min": -87.0, "episode_reward_mean": -12.962264150943396, "episode_len_mean": 38.64150943396226, "episode_media": {}, "episodes_this_iter": 106, "episodes_timesteps_total": 4096, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, -39.0, -18.0, -10.0, -23.0, -5.0, -33.0, -74.0, -24.0, -31.0, 23.0, 21.0, -71.0, -10.0, 20.0, -44.0, -39.0, -54.0, -25.0, 11.0, 30.0, -7.0, -19.0, -22.0, 21.0, 47.0, -9.0, -87.0, 28.0, -40.0, -35.0, -15.0, 51.0, -76.0, 8.0, 78.0, -37.0, 28.0, -35.0, -41.0, -41.0, -26.0, 29.0, -7.0, -23.0, -55.0, 53.0, -3.0, 2.0, -39.0, -17.0, -18.0, 49.0, -23.0, -39.0, -18.0, -53.0, 32.0, -15.0, -16.0, 31.0, 65.0, -38.0, 45.0, -43.0, -31.0, -21.0, -9.0, -37.0, 35.0, 54.0, -42.0, -41.0, 36.0, -10.0, -42.0, -9.0, 36.0, -48.0, -47.0, -28.0, 30.0, -2.0, -71.0, -9.0, -35.0, -3.0, -31.0, 50.0, -56.0, 3.0, 63.0, -39.0, 37.0, -31.0, -15.0, 7.0, -48.0, -72.0, 22.0, -76.0, -27.0, -37.0, -33.0, -32.0, -43.0], "episode_lengths": [112, 4, 67, 21, 14, 44, 16, 29, 37, 42, 6, 4, 38, 45, 81, 11, 16, 67, 30, 24, 19, 84, 12, 63, 4, 52, 46, 58, 47, 9, 8, 22, 22, 75, 15, 107, 6, 65, 14, 20, 20, 11, 132, 36, 14, 42, 16, 76, 117, 4, 20, 37, 128, 8, 34, 49, 32, 27, 22, 39, 20, 78, 5, 16, 6, 36, 58, 76, 42, 30, 61, 31, 20, 35, 75, 19, 34, 55, 163, 14, 15, 25, 23, 44, 106, 14, 34, 18, 31, 29, 58, 32, 34, 38, 12, 28, 20, 31, 19, 11, 39, 10, 78, 124, 11, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2580676592545612, "mean_inference_ms": 1.7112948558557217, "mean_action_processing_ms": 0.0913423475111815, "mean_env_wait_ms": 0.18859873135063449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021871305861563054, "StateBufferConnector_ms": 0.0044804699016067215, "ViewRequirementAgentConnector_ms": 0.09337528696599996}, "num_episodes": 106, "episode_return_max": 78.0, "episode_return_min": -87.0, "episode_return_mean": -12.962264150943396}, "env_runner_results": {"episode_reward_max": 78.0, "episode_reward_min": -87.0, "episode_reward_mean": -12.962264150943396, "episode_len_mean": 38.64150943396226, "episode_media": {}, "episodes_this_iter": 106, "episodes_timesteps_total": 4096, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, -39.0, -18.0, -10.0, -23.0, -5.0, -33.0, -74.0, -24.0, -31.0, 23.0, 21.0, -71.0, -10.0, 20.0, -44.0, -39.0, -54.0, -25.0, 11.0, 30.0, -7.0, -19.0, -22.0, 21.0, 47.0, -9.0, -87.0, 28.0, -40.0, -35.0, -15.0, 51.0, -76.0, 8.0, 78.0, -37.0, 28.0, -35.0, -41.0, -41.0, -26.0, 29.0, -7.0, -23.0, -55.0, 53.0, -3.0, 2.0, -39.0, -17.0, -18.0, 49.0, -23.0, -39.0, -18.0, -53.0, 32.0, -15.0, -16.0, 31.0, 65.0, -38.0, 45.0, -43.0, -31.0, -21.0, -9.0, -37.0, 35.0, 54.0, -42.0, -41.0, 36.0, -10.0, -42.0, -9.0, 36.0, -48.0, -47.0, -28.0, 30.0, -2.0, -71.0, -9.0, -35.0, -3.0, -31.0, 50.0, -56.0, 3.0, 63.0, -39.0, 37.0, -31.0, -15.0, 7.0, -48.0, -72.0, 22.0, -76.0, -27.0, -37.0, -33.0, -32.0, -43.0], "episode_lengths": [112, 4, 67, 21, 14, 44, 16, 29, 37, 42, 6, 4, 38, 45, 81, 11, 16, 67, 30, 24, 19, 84, 12, 63, 4, 52, 46, 58, 47, 9, 8, 22, 22, 75, 15, 107, 6, 65, 14, 20, 20, 11, 132, 36, 14, 42, 16, 76, 117, 4, 20, 37, 128, 8, 34, 49, 32, 27, 22, 39, 20, 78, 5, 16, 6, 36, 58, 76, 42, 30, 61, 31, 20, 35, 75, 19, 34, 55, 163, 14, 15, 25, 23, 44, 106, 14, 34, 18, 31, 29, 58, 32, 34, 38, 12, 28, 20, 31, 19, 11, 39, 10, 78, 124, 11, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2580676592545612, "mean_inference_ms": 1.7112948558557217, "mean_action_processing_ms": 0.0913423475111815, "mean_env_wait_ms": 0.18859873135063449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021871305861563054, "StateBufferConnector_ms": 0.0044804699016067215, "ViewRequirementAgentConnector_ms": 0.09337528696599996}, "num_episodes": 106, "episode_return_max": 78.0, "episode_return_min": -87.0, "episode_return_mean": -12.962264150943396}, "episode_reward_max": 78.0, "episode_reward_min": -87.0, "episode_reward_mean": -12.962264150943396, "episode_len_mean": 38.64150943396226, "episodes_this_iter": 106, "episodes_timesteps_total": 4096, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.0, -39.0, -18.0, -10.0, -23.0, -5.0, -33.0, -74.0, -24.0, -31.0, 23.0, 21.0, -71.0, -10.0, 20.0, -44.0, -39.0, -54.0, -25.0, 11.0, 30.0, -7.0, -19.0, -22.0, 21.0, 47.0, -9.0, -87.0, 28.0, -40.0, -35.0, -15.0, 51.0, -76.0, 8.0, 78.0, -37.0, 28.0, -35.0, -41.0, -41.0, -26.0, 29.0, -7.0, -23.0, -55.0, 53.0, -3.0, 2.0, -39.0, -17.0, -18.0, 49.0, -23.0, -39.0, -18.0, -53.0, 32.0, -15.0, -16.0, 31.0, 65.0, -38.0, 45.0, -43.0, -31.0, -21.0, -9.0, -37.0, 35.0, 54.0, -42.0, -41.0, 36.0, -10.0, -42.0, -9.0, 36.0, -48.0, -47.0, -28.0, 30.0, -2.0, -71.0, -9.0, -35.0, -3.0, -31.0, 50.0, -56.0, 3.0, 63.0, -39.0, 37.0, -31.0, -15.0, 7.0, -48.0, -72.0, 22.0, -76.0, -27.0, -37.0, -33.0, -32.0, -43.0], "episode_lengths": [112, 4, 67, 21, 14, 44, 16, 29, 37, 42, 6, 4, 38, 45, 81, 11, 16, 67, 30, 24, 19, 84, 12, 63, 4, 52, 46, 58, 47, 9, 8, 22, 22, 75, 15, 107, 6, 65, 14, 20, 20, 11, 132, 36, 14, 42, 16, 76, 117, 4, 20, 37, 128, 8, 34, 49, 32, 27, 22, 39, 20, 78, 5, 16, 6, 36, 58, 76, 42, 30, 61, 31, 20, 35, 75, 19, 34, 55, 163, 14, 15, 25, 23, 44, 106, 14, 34, 18, 31, 29, 58, 32, 34, 38, 12, 28, 20, 31, 19, 11, 39, 10, 78, 124, 11, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2580676592545612, "mean_inference_ms": 1.7112948558557217, "mean_action_processing_ms": 0.0913423475111815, "mean_env_wait_ms": 0.18859873135063449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021871305861563054, "StateBufferConnector_ms": 0.0044804699016067215, "ViewRequirementAgentConnector_ms": 0.09337528696599996}, "num_episodes": 106, "episode_return_max": 78.0, "episode_return_min": -87.0, "episode_return_mean": -12.962264150943396, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 220.00267640031893, "num_env_steps_trained_throughput_per_sec": 220.00267640031893, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 17493.732, "restore_workers_time_ms": 0.016, "training_step_time_ms": 17493.673, "sample_time_ms": 9045.228, "load_time_ms": 0.376, "load_throughput": 10627459.459, "learn_time_ms": 8440.467, "learn_throughput": 473.907, "synch_weights_time_ms": 6.949}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 406, "training_iteration": 3, "trial_id": "default", "date": "2024-05-20_21-23-31", "timestamp": 1716265411, "time_this_iter_s": 18.189491271972656, "time_total_s": 52.51590967178345, "pid": 2798, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147c08220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 200.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 52.51590967178345, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 46.896153846153844, "ram_util_percent": 57.48461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 80.40962439461421, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 149.9374162817514, "policy_loss": -0.01121554099103456, "vf_loss": 149.94441876155074, "vf_explained_var": 0.014050965347597677, "kl": 0.021064812660899556, "entropy": 1.2475362863591921, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 141.0, "episode_reward_min": -122.0, "episode_reward_mean": -3.51, "episode_len_mean": 56.11, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 5611, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.0, -21.0, -9.0, -37.0, 35.0, 54.0, -42.0, -41.0, 36.0, -10.0, -42.0, -9.0, 36.0, -48.0, -47.0, -28.0, 30.0, -2.0, -71.0, -9.0, -35.0, -3.0, -31.0, 50.0, -56.0, 3.0, 63.0, -39.0, 37.0, -31.0, -15.0, 7.0, -48.0, -72.0, 22.0, -76.0, -27.0, -37.0, -33.0, -32.0, -43.0, -10.0, 11.0, -76.0, -24.0, -13.0, 39.0, 27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0], "episode_lengths": [36, 58, 76, 42, 30, 61, 31, 20, 35, 75, 19, 34, 55, 163, 14, 15, 25, 23, 44, 106, 14, 34, 18, 31, 29, 58, 32, 34, 38, 12, 28, 20, 31, 19, 11, 39, 10, 78, 124, 11, 18, 15, 18, 69, 19, 60, 44, 88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25400103056210377, "mean_inference_ms": 1.6988382435571494, "mean_action_processing_ms": 0.09070402056518208, "mean_env_wait_ms": 0.18913938045129475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01970505714416504, "StateBufferConnector_ms": 0.0039021968841552734, "ViewRequirementAgentConnector_ms": 0.08361625671386719}, "num_episodes": 59, "episode_return_max": 141.0, "episode_return_min": -122.0, "episode_return_mean": -3.51}, "env_runner_results": {"episode_reward_max": 141.0, "episode_reward_min": -122.0, "episode_reward_mean": -3.51, "episode_len_mean": 56.11, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 5611, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.0, -21.0, -9.0, -37.0, 35.0, 54.0, -42.0, -41.0, 36.0, -10.0, -42.0, -9.0, 36.0, -48.0, -47.0, -28.0, 30.0, -2.0, -71.0, -9.0, -35.0, -3.0, -31.0, 50.0, -56.0, 3.0, 63.0, -39.0, 37.0, -31.0, -15.0, 7.0, -48.0, -72.0, 22.0, -76.0, -27.0, -37.0, -33.0, -32.0, -43.0, -10.0, 11.0, -76.0, -24.0, -13.0, 39.0, 27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0], "episode_lengths": [36, 58, 76, 42, 30, 61, 31, 20, 35, 75, 19, 34, 55, 163, 14, 15, 25, 23, 44, 106, 14, 34, 18, 31, 29, 58, 32, 34, 38, 12, 28, 20, 31, 19, 11, 39, 10, 78, 124, 11, 18, 15, 18, 69, 19, 60, 44, 88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25400103056210377, "mean_inference_ms": 1.6988382435571494, "mean_action_processing_ms": 0.09070402056518208, "mean_env_wait_ms": 0.18913938045129475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01970505714416504, "StateBufferConnector_ms": 0.0039021968841552734, "ViewRequirementAgentConnector_ms": 0.08361625671386719}, "num_episodes": 59, "episode_return_max": 141.0, "episode_return_min": -122.0, "episode_return_mean": -3.51}, "episode_reward_max": 141.0, "episode_reward_min": -122.0, "episode_reward_mean": -3.51, "episode_len_mean": 56.11, "episodes_this_iter": 59, "episodes_timesteps_total": 5611, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31.0, -21.0, -9.0, -37.0, 35.0, 54.0, -42.0, -41.0, 36.0, -10.0, -42.0, -9.0, 36.0, -48.0, -47.0, -28.0, 30.0, -2.0, -71.0, -9.0, -35.0, -3.0, -31.0, 50.0, -56.0, 3.0, 63.0, -39.0, 37.0, -31.0, -15.0, 7.0, -48.0, -72.0, 22.0, -76.0, -27.0, -37.0, -33.0, -32.0, -43.0, -10.0, 11.0, -76.0, -24.0, -13.0, 39.0, 27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0], "episode_lengths": [36, 58, 76, 42, 30, 61, 31, 20, 35, 75, 19, 34, 55, 163, 14, 15, 25, 23, 44, 106, 14, 34, 18, 31, 29, 58, 32, 34, 38, 12, 28, 20, 31, 19, 11, 39, 10, 78, 124, 11, 18, 15, 18, 69, 19, 60, 44, 88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25400103056210377, "mean_inference_ms": 1.6988382435571494, "mean_action_processing_ms": 0.09070402056518208, "mean_env_wait_ms": 0.18913938045129475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01970505714416504, "StateBufferConnector_ms": 0.0039021968841552734, "ViewRequirementAgentConnector_ms": 0.08361625671386719}, "num_episodes": 59, "episode_return_max": 141.0, "episode_return_min": -122.0, "episode_return_mean": -3.51, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 248.10819383287014, "num_env_steps_trained_throughput_per_sec": 248.10819383287014, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 17150.802, "restore_workers_time_ms": 0.016, "training_step_time_ms": 17150.744, "sample_time_ms": 8931.414, "load_time_ms": 0.361, "load_throughput": 11070416.364, "learn_time_ms": 8211.465, "learn_throughput": 487.124, "synch_weights_time_ms": 6.902}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 465, "training_iteration": 4, "trial_id": "default", "date": "2024-05-20_21-23-47", "timestamp": 1716265427, "time_this_iter_s": 16.129058837890625, "time_total_s": 68.64496850967407, "pid": 2798, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147c08220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 200.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 68.64496850967407, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 39.89565217391304, "ram_util_percent": 57.44782608695651}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 111.254697104936, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 142.37440420171265, "policy_loss": -0.009734108535352573, "vf_loss": 142.38000228225545, "vf_explained_var": -0.020463373199585945, "kl": 0.013788769840180832, "entropy": 1.1860708908368183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 467.0, "episode_reward_min": -122.0, "episode_reward_mean": 22.53, "episode_len_mean": 86.07, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 8607, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -31.0, 50.0, -56.0, 3.0, 63.0, -39.0, 37.0, -31.0, -15.0, 7.0, -48.0, -72.0, 22.0, -76.0, -27.0, -37.0, -33.0, -32.0, -43.0, -10.0, 11.0, -76.0, -24.0, -13.0, 39.0, 27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0], "episode_lengths": [34, 18, 31, 29, 58, 32, 34, 38, 12, 28, 20, 31, 19, 11, 39, 10, 78, 124, 11, 18, 15, 18, 69, 19, 60, 44, 88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2510293294432536, "mean_inference_ms": 1.6886786553289455, "mean_action_processing_ms": 0.09017934873754925, "mean_env_wait_ms": 0.1894449037776935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018838882446289062, "StateBufferConnector_ms": 0.0037860870361328125, "ViewRequirementAgentConnector_ms": 0.08083391189575195}, "num_episodes": 21, "episode_return_max": 467.0, "episode_return_min": -122.0, "episode_return_mean": 22.53}, "env_runner_results": {"episode_reward_max": 467.0, "episode_reward_min": -122.0, "episode_reward_mean": 22.53, "episode_len_mean": 86.07, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 8607, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -31.0, 50.0, -56.0, 3.0, 63.0, -39.0, 37.0, -31.0, -15.0, 7.0, -48.0, -72.0, 22.0, -76.0, -27.0, -37.0, -33.0, -32.0, -43.0, -10.0, 11.0, -76.0, -24.0, -13.0, 39.0, 27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0], "episode_lengths": [34, 18, 31, 29, 58, 32, 34, 38, 12, 28, 20, 31, 19, 11, 39, 10, 78, 124, 11, 18, 15, 18, 69, 19, 60, 44, 88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2510293294432536, "mean_inference_ms": 1.6886786553289455, "mean_action_processing_ms": 0.09017934873754925, "mean_env_wait_ms": 0.1894449037776935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018838882446289062, "StateBufferConnector_ms": 0.0037860870361328125, "ViewRequirementAgentConnector_ms": 0.08083391189575195}, "num_episodes": 21, "episode_return_max": 467.0, "episode_return_min": -122.0, "episode_return_mean": 22.53}, "episode_reward_max": 467.0, "episode_reward_min": -122.0, "episode_reward_mean": 22.53, "episode_len_mean": 86.07, "episodes_this_iter": 21, "episodes_timesteps_total": 8607, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -31.0, 50.0, -56.0, 3.0, 63.0, -39.0, 37.0, -31.0, -15.0, 7.0, -48.0, -72.0, 22.0, -76.0, -27.0, -37.0, -33.0, -32.0, -43.0, -10.0, 11.0, -76.0, -24.0, -13.0, 39.0, 27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0], "episode_lengths": [34, 18, 31, 29, 58, 32, 34, 38, 12, 28, 20, 31, 19, 11, 39, 10, 78, 124, 11, 18, 15, 18, 69, 19, 60, 44, 88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2510293294432536, "mean_inference_ms": 1.6886786553289455, "mean_action_processing_ms": 0.09017934873754925, "mean_env_wait_ms": 0.1894449037776935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018838882446289062, "StateBufferConnector_ms": 0.0037860870361328125, "ViewRequirementAgentConnector_ms": 0.08083391189575195}, "num_episodes": 21, "episode_return_max": 467.0, "episode_return_min": -122.0, "episode_return_mean": 22.53, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.4671707752593, "num_env_steps_trained_throughput_per_sec": 254.4671707752593, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 16864.467, "restore_workers_time_ms": 0.015, "training_step_time_ms": 16864.414, "sample_time_ms": 8788.225, "load_time_ms": 0.351, "load_throughput": 11394468.894, "learn_time_ms": 8068.417, "learn_throughput": 495.76, "synch_weights_time_ms": 6.856}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 486, "training_iteration": 5, "trial_id": "default", "date": "2024-05-20_21-24-03", "timestamp": 1716265443, "time_this_iter_s": 15.72585415840149, "time_total_s": 84.37082266807556, "pid": 2798, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147c08220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 200.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 84.37082266807556, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.026086956521745, "ram_util_percent": 57.26086956521739}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 130.64527216246051, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 136.62997162521526, "policy_loss": -0.01188288709669504, "vf_loss": 136.63773013289256, "vf_explained_var": -0.035825926257717994, "kl": 0.013748791386288326, "entropy": 1.1361109336217246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 590.0, "episode_reward_min": -122.0, "episode_reward_mean": 49.16, "episode_len_mean": 121.3, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 12130, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.0, -32.0, -43.0, -10.0, 11.0, -76.0, -24.0, -13.0, 39.0, 27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0, 321.0, -1.0, 590.0, 15.0, -11.0, 12.0, 414.0, 73.0, 109.0, -17.0, 207.0, -38.0, 153.0, 57.0, 242.0, 180.0, 104.0], "episode_lengths": [124, 11, 18, 15, 18, 69, 19, 60, 44, 88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57, 538, 132, 795, 70, 74, 91, 745, 176, 96, 44, 256, 23, 278, 34, 253, 275, 165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24893164637848603, "mean_inference_ms": 1.6868987845681582, "mean_action_processing_ms": 0.0900070716701452, "mean_env_wait_ms": 0.19073027402462728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018696069717407227, "StateBufferConnector_ms": 0.003805875778198242, "ViewRequirementAgentConnector_ms": 0.08155226707458496}, "num_episodes": 17, "episode_return_max": 590.0, "episode_return_min": -122.0, "episode_return_mean": 49.16}, "env_runner_results": {"episode_reward_max": 590.0, "episode_reward_min": -122.0, "episode_reward_mean": 49.16, "episode_len_mean": 121.3, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 12130, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.0, -32.0, -43.0, -10.0, 11.0, -76.0, -24.0, -13.0, 39.0, 27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0, 321.0, -1.0, 590.0, 15.0, -11.0, 12.0, 414.0, 73.0, 109.0, -17.0, 207.0, -38.0, 153.0, 57.0, 242.0, 180.0, 104.0], "episode_lengths": [124, 11, 18, 15, 18, 69, 19, 60, 44, 88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57, 538, 132, 795, 70, 74, 91, 745, 176, 96, 44, 256, 23, 278, 34, 253, 275, 165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24893164637848603, "mean_inference_ms": 1.6868987845681582, "mean_action_processing_ms": 0.0900070716701452, "mean_env_wait_ms": 0.19073027402462728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018696069717407227, "StateBufferConnector_ms": 0.003805875778198242, "ViewRequirementAgentConnector_ms": 0.08155226707458496}, "num_episodes": 17, "episode_return_max": 590.0, "episode_return_min": -122.0, "episode_return_mean": 49.16}, "episode_reward_max": 590.0, "episode_reward_min": -122.0, "episode_reward_mean": 49.16, "episode_len_mean": 121.3, "episodes_this_iter": 17, "episodes_timesteps_total": 12130, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-33.0, -32.0, -43.0, -10.0, 11.0, -76.0, -24.0, -13.0, 39.0, 27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0, 321.0, -1.0, 590.0, 15.0, -11.0, 12.0, 414.0, 73.0, 109.0, -17.0, 207.0, -38.0, 153.0, 57.0, 242.0, 180.0, 104.0], "episode_lengths": [124, 11, 18, 15, 18, 69, 19, 60, 44, 88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57, 538, 132, 795, 70, 74, 91, 745, 176, 96, 44, 256, 23, 278, 34, 253, 275, 165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24893164637848603, "mean_inference_ms": 1.6868987845681582, "mean_action_processing_ms": 0.0900070716701452, "mean_env_wait_ms": 0.19073027402462728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018696069717407227, "StateBufferConnector_ms": 0.003805875778198242, "ViewRequirementAgentConnector_ms": 0.08155226707458496}, "num_episodes": 17, "episode_return_max": 590.0, "episode_return_min": -122.0, "episode_return_mean": 49.16, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 227.32833205698503, "num_env_steps_trained_throughput_per_sec": 227.32833205698503, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 16986.339, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16986.29, "sample_time_ms": 8977.827, "load_time_ms": 0.346, "load_throughput": 11553230.345, "learn_time_ms": 8000.985, "learn_throughput": 499.938, "synch_weights_time_ms": 6.585}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 503, "training_iteration": 6, "trial_id": "default", "date": "2024-05-20_21-24-21", "timestamp": 1716265461, "time_this_iter_s": 17.601927042007446, "time_total_s": 101.97274971008301, "pid": 2798, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147c08220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 200.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 101.97274971008301, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 43.504, "ram_util_percent": 57.148}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 172.66110434426415, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 121.84199803260064, "policy_loss": -0.007191214712476858, "vf_loss": 121.84611368384412, "vf_explained_var": -0.020387073486082017, "kl": 0.010251571505026367, "entropy": 1.0874884807294416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 990.0, "episode_reward_min": -122.0, "episode_reward_mean": 78.74, "episode_len_mean": 153.72, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 15372, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0, 321.0, -1.0, 590.0, 15.0, -11.0, 12.0, 414.0, 73.0, 109.0, -17.0, 207.0, -38.0, 153.0, 57.0, 242.0, 180.0, 104.0, 191.0, 411.0, 649.0, 48.0, 190.0, 203.0, 990.0, 56.0], "episode_lengths": [44, 88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57, 538, 132, 795, 70, 74, 91, 745, 176, 96, 44, 256, 23, 278, 34, 253, 275, 165, 186, 550, 780, 109, 311, 264, 1351, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24793087722329832, "mean_inference_ms": 1.6855415333582295, "mean_action_processing_ms": 0.08990696887345241, "mean_env_wait_ms": 0.19127899132564655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018398284912109375, "StateBufferConnector_ms": 0.0037424564361572266, "ViewRequirementAgentConnector_ms": 0.08077692985534668}, "num_episodes": 8, "episode_return_max": 990.0, "episode_return_min": -122.0, "episode_return_mean": 78.74}, "env_runner_results": {"episode_reward_max": 990.0, "episode_reward_min": -122.0, "episode_reward_mean": 78.74, "episode_len_mean": 153.72, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 15372, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0, 321.0, -1.0, 590.0, 15.0, -11.0, 12.0, 414.0, 73.0, 109.0, -17.0, 207.0, -38.0, 153.0, 57.0, 242.0, 180.0, 104.0, 191.0, 411.0, 649.0, 48.0, 190.0, 203.0, 990.0, 56.0], "episode_lengths": [44, 88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57, 538, 132, 795, 70, 74, 91, 745, 176, 96, 44, 256, 23, 278, 34, 253, 275, 165, 186, 550, 780, 109, 311, 264, 1351, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24793087722329832, "mean_inference_ms": 1.6855415333582295, "mean_action_processing_ms": 0.08990696887345241, "mean_env_wait_ms": 0.19127899132564655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018398284912109375, "StateBufferConnector_ms": 0.0037424564361572266, "ViewRequirementAgentConnector_ms": 0.08077692985534668}, "num_episodes": 8, "episode_return_max": 990.0, "episode_return_min": -122.0, "episode_return_mean": 78.74}, "episode_reward_max": 990.0, "episode_reward_min": -122.0, "episode_reward_mean": 78.74, "episode_len_mean": 153.72, "episodes_this_iter": 8, "episodes_timesteps_total": 15372, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.0, 27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0, 321.0, -1.0, 590.0, 15.0, -11.0, 12.0, 414.0, 73.0, 109.0, -17.0, 207.0, -38.0, 153.0, 57.0, 242.0, 180.0, 104.0, 191.0, 411.0, 649.0, 48.0, 190.0, 203.0, 990.0, 56.0], "episode_lengths": [44, 88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57, 538, 132, 795, 70, 74, 91, 745, 176, 96, 44, 256, 23, 278, 34, 253, 275, 165, 186, 550, 780, 109, 311, 264, 1351, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24793087722329832, "mean_inference_ms": 1.6855415333582295, "mean_action_processing_ms": 0.08990696887345241, "mean_env_wait_ms": 0.19127899132564655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018398284912109375, "StateBufferConnector_ms": 0.0037424564361572266, "ViewRequirementAgentConnector_ms": 0.08077692985534668}, "num_episodes": 8, "episode_return_max": 990.0, "episode_return_min": -122.0, "episode_return_mean": 78.74, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.22103205099964, "num_env_steps_trained_throughput_per_sec": 246.22103205099964, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 16880.516, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16880.469, "sample_time_ms": 8876.055, "load_time_ms": 0.341, "load_throughput": 11738182.109, "learn_time_ms": 7996.928, "learn_throughput": 500.192, "synch_weights_time_ms": 6.607}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 511, "training_iteration": 7, "trial_id": "default", "date": "2024-05-20_21-24-37", "timestamp": 1716265477, "time_this_iter_s": 16.251955270767212, "time_total_s": 118.22470498085022, "pid": 2798, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147c08220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 200.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 118.22470498085022, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 41.01304347826087, "ram_util_percent": 56.9608695652174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 254.5633175598037, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 72.53166623166813, "policy_loss": -0.009110786513455453, "vf_loss": 72.53817573926781, "vf_explained_var": -0.020781780699247954, "kl": 0.008670849945174515, "entropy": 0.9790531535302439, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 990.0, "episode_reward_min": -122.0, "episode_reward_mean": 86.34, "episode_len_mean": 163.5, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 16350, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0, 321.0, -1.0, 590.0, 15.0, -11.0, 12.0, 414.0, 73.0, 109.0, -17.0, 207.0, -38.0, 153.0, 57.0, 242.0, 180.0, 104.0, 191.0, 411.0, 649.0, 48.0, 190.0, 203.0, 990.0, 56.0, 799.0], "episode_lengths": [88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57, 538, 132, 795, 70, 74, 91, 745, 176, 96, 44, 256, 23, 278, 34, 253, 275, 165, 186, 550, 780, 109, 311, 264, 1351, 25, 1022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2478176842761756, "mean_inference_ms": 1.685523841102077, "mean_action_processing_ms": 0.0899027294452495, "mean_env_wait_ms": 0.1913711235096188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018328428268432617, "StateBufferConnector_ms": 0.0037336349487304688, "ViewRequirementAgentConnector_ms": 0.08058333396911621}, "num_episodes": 1, "episode_return_max": 990.0, "episode_return_min": -122.0, "episode_return_mean": 86.34}, "env_runner_results": {"episode_reward_max": 990.0, "episode_reward_min": -122.0, "episode_reward_mean": 86.34, "episode_len_mean": 163.5, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 16350, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0, 321.0, -1.0, 590.0, 15.0, -11.0, 12.0, 414.0, 73.0, 109.0, -17.0, 207.0, -38.0, 153.0, 57.0, 242.0, 180.0, 104.0, 191.0, 411.0, 649.0, 48.0, 190.0, 203.0, 990.0, 56.0, 799.0], "episode_lengths": [88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57, 538, 132, 795, 70, 74, 91, 745, 176, 96, 44, 256, 23, 278, 34, 253, 275, 165, 186, 550, 780, 109, 311, 264, 1351, 25, 1022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2478176842761756, "mean_inference_ms": 1.685523841102077, "mean_action_processing_ms": 0.0899027294452495, "mean_env_wait_ms": 0.1913711235096188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018328428268432617, "StateBufferConnector_ms": 0.0037336349487304688, "ViewRequirementAgentConnector_ms": 0.08058333396911621}, "num_episodes": 1, "episode_return_max": 990.0, "episode_return_min": -122.0, "episode_return_mean": 86.34}, "episode_reward_max": 990.0, "episode_reward_min": -122.0, "episode_reward_mean": 86.34, "episode_len_mean": 163.5, "episodes_this_iter": 1, "episodes_timesteps_total": 16350, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0, 321.0, -1.0, 590.0, 15.0, -11.0, 12.0, 414.0, 73.0, 109.0, -17.0, 207.0, -38.0, 153.0, 57.0, 242.0, 180.0, 104.0, 191.0, 411.0, 649.0, 48.0, 190.0, 203.0, 990.0, 56.0, 799.0], "episode_lengths": [88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57, 538, 132, 795, 70, 74, 91, 745, 176, 96, 44, 256, 23, 278, 34, 253, 275, 165, 186, 550, 780, 109, 311, 264, 1351, 25, 1022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2478176842761756, "mean_inference_ms": 1.685523841102077, "mean_action_processing_ms": 0.0899027294452495, "mean_env_wait_ms": 0.1913711235096188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018328428268432617, "StateBufferConnector_ms": 0.0037336349487304688, "ViewRequirementAgentConnector_ms": 0.08058333396911621}, "num_episodes": 1, "episode_return_max": 990.0, "episode_return_min": -122.0, "episode_return_mean": 86.34, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 229.0075862819711, "num_env_steps_trained_throughput_per_sec": 229.0075862819711, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 16953.786, "restore_workers_time_ms": 0.013, "training_step_time_ms": 16953.741, "sample_time_ms": 8912.216, "load_time_ms": 0.349, "load_throughput": 11472581.246, "learn_time_ms": 8034.138, "learn_throughput": 497.875, "synch_weights_time_ms": 6.505}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 512, "training_iteration": 8, "trial_id": "default", "date": "2024-05-20_21-24-54", "timestamp": 1716265494, "time_this_iter_s": 17.475550413131714, "time_total_s": 135.70025539398193, "pid": 2798, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147c08220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 200.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 135.70025539398193, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 47.70000000000001, "ram_util_percent": 56.688}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 223.82763452029997, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 37.241622172632525, "policy_loss": -0.010757192817106041, "vf_loss": 37.25059805044564, "vf_explained_var": -0.09642569576540301, "kl": 0.00593728166560222, "entropy": 0.9524367938118596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 990.0, "episode_reward_min": -122.0, "episode_reward_mean": 86.34, "episode_len_mean": 163.5, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 16350, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0, 321.0, -1.0, 590.0, 15.0, -11.0, 12.0, 414.0, 73.0, 109.0, -17.0, 207.0, -38.0, 153.0, 57.0, 242.0, 180.0, 104.0, 191.0, 411.0, 649.0, 48.0, 190.0, 203.0, 990.0, 56.0, 799.0], "episode_lengths": [88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57, 538, 132, 795, 70, 74, 91, 745, 176, 96, 44, 256, 23, 278, 34, 253, 275, 165, 186, 550, 780, 109, 311, 264, 1351, 25, 1022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2478176842761756, "mean_inference_ms": 1.685523841102077, "mean_action_processing_ms": 0.0899027294452495, "mean_env_wait_ms": 0.1913711235096188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018328428268432617, "StateBufferConnector_ms": 0.0037336349487304688, "ViewRequirementAgentConnector_ms": 0.08058333396911621}, "num_episodes": 0, "episode_return_max": 990.0, "episode_return_min": -122.0, "episode_return_mean": 86.34}, "env_runner_results": {"episode_reward_max": 990.0, "episode_reward_min": -122.0, "episode_reward_mean": 86.34, "episode_len_mean": 163.5, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 16350, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0, 321.0, -1.0, 590.0, 15.0, -11.0, 12.0, 414.0, 73.0, 109.0, -17.0, 207.0, -38.0, 153.0, 57.0, 242.0, 180.0, 104.0, 191.0, 411.0, 649.0, 48.0, 190.0, 203.0, 990.0, 56.0, 799.0], "episode_lengths": [88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57, 538, 132, 795, 70, 74, 91, 745, 176, 96, 44, 256, 23, 278, 34, 253, 275, 165, 186, 550, 780, 109, 311, 264, 1351, 25, 1022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2478176842761756, "mean_inference_ms": 1.685523841102077, "mean_action_processing_ms": 0.0899027294452495, "mean_env_wait_ms": 0.1913711235096188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018328428268432617, "StateBufferConnector_ms": 0.0037336349487304688, "ViewRequirementAgentConnector_ms": 0.08058333396911621}, "num_episodes": 0, "episode_return_max": 990.0, "episode_return_min": -122.0, "episode_return_mean": 86.34}, "episode_reward_max": 990.0, "episode_reward_min": -122.0, "episode_reward_mean": 86.34, "episode_len_mean": 163.5, "episodes_this_iter": 0, "episodes_timesteps_total": 16350, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0, 321.0, -1.0, 590.0, 15.0, -11.0, 12.0, 414.0, 73.0, 109.0, -17.0, 207.0, -38.0, 153.0, 57.0, 242.0, 180.0, 104.0, 191.0, 411.0, 649.0, 48.0, 190.0, 203.0, 990.0, 56.0, 799.0], "episode_lengths": [88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57, 538, 132, 795, 70, 74, 91, 745, 176, 96, 44, 256, 23, 278, 34, 253, 275, 165, 186, 550, 780, 109, 311, 264, 1351, 25, 1022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2478176842761756, "mean_inference_ms": 1.685523841102077, "mean_action_processing_ms": 0.0899027294452495, "mean_env_wait_ms": 0.1913711235096188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018328428268432617, "StateBufferConnector_ms": 0.0037336349487304688, "ViewRequirementAgentConnector_ms": 0.08058333396911621}, "num_episodes": 0, "episode_return_max": 990.0, "episode_return_min": -122.0, "episode_return_mean": 86.34, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.6461161038804, "num_env_steps_trained_throughput_per_sec": 240.6461161038804, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 16916.912, "restore_workers_time_ms": 0.013, "training_step_time_ms": 16916.869, "sample_time_ms": 8896.931, "load_time_ms": 0.345, "load_throughput": 11605175.928, "learn_time_ms": 8012.309, "learn_throughput": 499.232, "synch_weights_time_ms": 6.742}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 512, "training_iteration": 9, "trial_id": "default", "date": "2024-05-20_21-25-11", "timestamp": 1716265511, "time_this_iter_s": 16.62932300567627, "time_total_s": 152.3295783996582, "pid": 2798, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147c08220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 200.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 152.3295783996582, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 42.07916666666667, "ram_util_percent": 56.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 185.2471687882818, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 26.929819044759196, "policy_loss": -0.0044488527040968655, "vf_loss": 26.932378805068232, "vf_explained_var": 0.002215863363717192, "kl": 0.006297022062083843, "entropy": 0.9123454372088114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 990.0, "episode_reward_min": -122.0, "episode_reward_mean": 86.34, "episode_len_mean": 163.5, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 16350, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0, 321.0, -1.0, 590.0, 15.0, -11.0, 12.0, 414.0, 73.0, 109.0, -17.0, 207.0, -38.0, 153.0, 57.0, 242.0, 180.0, 104.0, 191.0, 411.0, 649.0, 48.0, 190.0, 203.0, 990.0, 56.0, 799.0], "episode_lengths": [88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57, 538, 132, 795, 70, 74, 91, 745, 176, 96, 44, 256, 23, 278, 34, 253, 275, 165, 186, 550, 780, 109, 311, 264, 1351, 25, 1022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2478176842761756, "mean_inference_ms": 1.685523841102077, "mean_action_processing_ms": 0.0899027294452495, "mean_env_wait_ms": 0.1913711235096188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018328428268432617, "StateBufferConnector_ms": 0.0037336349487304688, "ViewRequirementAgentConnector_ms": 0.08058333396911621}, "num_episodes": 0, "episode_return_max": 990.0, "episode_return_min": -122.0, "episode_return_mean": 86.34}, "env_runner_results": {"episode_reward_max": 990.0, "episode_reward_min": -122.0, "episode_reward_mean": 86.34, "episode_len_mean": 163.5, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 16350, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0, 321.0, -1.0, 590.0, 15.0, -11.0, 12.0, 414.0, 73.0, 109.0, -17.0, 207.0, -38.0, 153.0, 57.0, 242.0, 180.0, 104.0, 191.0, 411.0, 649.0, 48.0, 190.0, 203.0, 990.0, 56.0, 799.0], "episode_lengths": [88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57, 538, 132, 795, 70, 74, 91, 745, 176, 96, 44, 256, 23, 278, 34, 253, 275, 165, 186, 550, 780, 109, 311, 264, 1351, 25, 1022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2478176842761756, "mean_inference_ms": 1.685523841102077, "mean_action_processing_ms": 0.0899027294452495, "mean_env_wait_ms": 0.1913711235096188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018328428268432617, "StateBufferConnector_ms": 0.0037336349487304688, "ViewRequirementAgentConnector_ms": 0.08058333396911621}, "num_episodes": 0, "episode_return_max": 990.0, "episode_return_min": -122.0, "episode_return_mean": 86.34}, "episode_reward_max": 990.0, "episode_reward_min": -122.0, "episode_reward_mean": 86.34, "episode_len_mean": 163.5, "episodes_this_iter": 0, "episodes_timesteps_total": 16350, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.0, -39.0, -36.0, -37.0, 61.0, 13.0, 15.0, -26.0, 20.0, 2.0, -20.0, -45.0, -9.0, -43.0, 24.0, -22.0, 28.0, 19.0, -9.0, -122.0, 35.0, 96.0, 79.0, -1.0, -29.0, -22.0, -20.0, -69.0, -20.0, 47.0, 70.0, 54.0, 141.0, 46.0, -36.0, 16.0, 39.0, -3.0, 35.0, 32.0, 42.0, 35.0, -13.0, -35.0, 39.0, 56.0, -10.0, 48.0, -12.0, -40.0, -22.0, -45.0, 40.0, 257.0, 175.0, 15.0, 82.0, 122.0, 158.0, -11.0, 74.0, 140.0, 46.0, 71.0, 329.0, 60.0, 31.0, 467.0, 33.0, 5.0, 107.0, 104.0, 40.0, 8.0, 321.0, -1.0, 590.0, 15.0, -11.0, 12.0, 414.0, 73.0, 109.0, -17.0, 207.0, -38.0, 153.0, 57.0, 242.0, 180.0, 104.0, 191.0, 411.0, 649.0, 48.0, 190.0, 203.0, 990.0, 56.0, 799.0], "episode_lengths": [88, 64, 7, 30, 68, 50, 70, 23, 15, 57, 137, 22, 82, 126, 7, 111, 21, 8, 52, 131, 162, 127, 62, 60, 68, 15, 59, 22, 23, 72, 65, 89, 334, 149, 13, 59, 112, 28, 150, 129, 79, 108, 42, 20, 28, 63, 105, 193, 25, 33, 39, 10, 23, 396, 230, 112, 215, 291, 219, 32, 87, 207, 155, 132, 600, 73, 26, 690, 34, 54, 96, 201, 65, 57, 538, 132, 795, 70, 74, 91, 745, 176, 96, 44, 256, 23, 278, 34, 253, 275, 165, 186, 550, 780, 109, 311, 264, 1351, 25, 1022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2478176842761756, "mean_inference_ms": 1.685523841102077, "mean_action_processing_ms": 0.0899027294452495, "mean_env_wait_ms": 0.1913711235096188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018328428268432617, "StateBufferConnector_ms": 0.0037336349487304688, "ViewRequirementAgentConnector_ms": 0.08058333396911621}, "num_episodes": 0, "episode_return_max": 990.0, "episode_return_min": -122.0, "episode_return_mean": 86.34, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 231.60708370332654, "num_env_steps_trained_throughput_per_sec": 231.60708370332654, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 16952.285, "restore_workers_time_ms": 0.013, "training_step_time_ms": 16952.243, "sample_time_ms": 8895.107, "load_time_ms": 0.34, "load_throughput": 11780925.497, "learn_time_ms": 8049.634, "learn_throughput": 496.917, "synch_weights_time_ms": 6.63}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 512, "training_iteration": 10, "trial_id": "default", "date": "2024-05-20_21-25-28", "timestamp": 1716265528, "time_this_iter_s": 17.278090953826904, "time_total_s": 169.6076693534851, "pid": 2798, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147c08220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 200.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 169.6076693534851, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 44.712500000000006, "ram_util_percent": 56.729166666666664}}
