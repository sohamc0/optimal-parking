{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 49.0, "episode_reward_min": -127.0, "episode_reward_mean": -23.75, "episode_len_mean": 31.0625, "episode_media": {}, "episodes_this_iter": 32, "episodes_timesteps_total": 994, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.0, -20.0, -32.0, 35.0, -45.0, 32.0, -23.0, 42.0, 10.0, -27.0, -69.0, -57.0, -50.0, -49.0, -20.0, -77.0, 17.0, -50.0, -53.0, 43.0, 15.0, -49.0, 49.0, -25.0, 11.0, -127.0, -64.0, -20.0, -50.0, -33.0, -2.0, -28.0], "episode_lengths": [17, 29, 5, 22, 76, 63, 38, 37, 23, 22, 46, 70, 17, 6, 35, 38, 24, 17, 44, 38, 10, 18, 6, 18, 18, 36, 33, 29, 17, 16, 45, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7070423244358182, "mean_inference_ms": 2.2807085549795665, "mean_action_processing_ms": 0.09913068194013018, "mean_env_wait_ms": 0.20582335335867746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02905130386352539, "StateBufferConnector_ms": 0.004962831735610962, "ViewRequirementAgentConnector_ms": 0.1180887222290039}, "num_episodes": 32, "episode_return_max": 49.0, "episode_return_min": -127.0, "episode_return_mean": -23.75}, "env_runner_results": {"episode_reward_max": 49.0, "episode_reward_min": -127.0, "episode_reward_mean": -23.75, "episode_len_mean": 31.0625, "episode_media": {}, "episodes_this_iter": 32, "episodes_timesteps_total": 994, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.0, -20.0, -32.0, 35.0, -45.0, 32.0, -23.0, 42.0, 10.0, -27.0, -69.0, -57.0, -50.0, -49.0, -20.0, -77.0, 17.0, -50.0, -53.0, 43.0, 15.0, -49.0, 49.0, -25.0, 11.0, -127.0, -64.0, -20.0, -50.0, -33.0, -2.0, -28.0], "episode_lengths": [17, 29, 5, 22, 76, 63, 38, 37, 23, 22, 46, 70, 17, 6, 35, 38, 24, 17, 44, 38, 10, 18, 6, 18, 18, 36, 33, 29, 17, 16, 45, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7070423244358182, "mean_inference_ms": 2.2807085549795665, "mean_action_processing_ms": 0.09913068194013018, "mean_env_wait_ms": 0.20582335335867746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02905130386352539, "StateBufferConnector_ms": 0.004962831735610962, "ViewRequirementAgentConnector_ms": 0.1180887222290039}, "num_episodes": 32, "episode_return_max": 49.0, "episode_return_min": -127.0, "episode_return_mean": -23.75}, "episode_reward_max": 49.0, "episode_reward_min": -127.0, "episode_reward_mean": -23.75, "episode_len_mean": 31.0625, "episodes_this_iter": 32, "episodes_timesteps_total": 994, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.0, -20.0, -32.0, 35.0, -45.0, 32.0, -23.0, 42.0, 10.0, -27.0, -69.0, -57.0, -50.0, -49.0, -20.0, -77.0, 17.0, -50.0, -53.0, 43.0, 15.0, -49.0, 49.0, -25.0, 11.0, -127.0, -64.0, -20.0, -50.0, -33.0, -2.0, -28.0], "episode_lengths": [17, 29, 5, 22, 76, 63, 38, 37, 23, 22, 46, 70, 17, 6, 35, 38, 24, 17, 44, 38, 10, 18, 6, 18, 18, 36, 33, 29, 17, 16, 45, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7070423244358182, "mean_inference_ms": 2.2807085549795665, "mean_action_processing_ms": 0.09913068194013018, "mean_env_wait_ms": 0.20582335335867746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02905130386352539, "StateBufferConnector_ms": 0.004962831735610962, "ViewRequirementAgentConnector_ms": 0.1180887222290039}, "num_episodes": 32, "episode_return_max": 49.0, "episode_return_min": -127.0, "episode_return_mean": -23.75, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 171.86846614741893, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1000, "num_env_steps_sampled_lifetime": 1000, "num_agent_steps_sampled_lifetime": 1000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1000, "timers": {"training_iteration_time_ms": 5818.413, "restore_workers_time_ms": 0.006, "training_step_time_ms": 5.834, "sample_time_ms": 5.585}, "counters": {"num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 32, "training_iteration": 1, "trial_id": "default", "date": "2024-05-20_22-45-01", "timestamp": 1716270301, "time_this_iter_s": 5.820908069610596, "time_total_s": 5.820908069610596, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5.820908069610596, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 39.35555555555556, "ram_util_percent": 51.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1057196855545044, "mean_q": -0.7838733196258545, "min_q": -27.390710830688477, "max_q": 8.614819526672363, "cur_lr": 0.0005}, "td_error": [-0.4195990562438965, -7.510904788970947, -0.7908532619476318, -1.9186738729476929, -25.677873611450195, 1.400958776473999, 0.16705322265625, -1.7210206985473633, -0.469362735748291, -20.05227279663086, -1.4139654636383057, -7.264113903045654, 0.2839391231536865, 3.7873311042785645, -0.37570762634277344, -7.320699214935303, -1.036412239074707, -2.7210960388183594, 0.02202606201171875, 5.473303318023682, -2.753908634185791, -0.9622180461883545, 25.782411575317383, -1.5249748229980469, -5.106900215148926, -5.523341178894043, -1.466029167175293, -3.12758207321167, -2.8835549354553223, 0.7091937065124512, -21.385181427001953, -0.3454606533050537], "mean_td_error": -2.692046642303467, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 999.0}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "last_target_update_ts": 1501, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": 49.0, "episode_reward_min": -127.0, "episode_reward_mean": -20.933333333333334, "episode_len_mean": 33.2, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 1992, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.0, -20.0, -32.0, 35.0, -45.0, 32.0, -23.0, 42.0, 10.0, -27.0, -69.0, -57.0, -50.0, -49.0, -20.0, -77.0, 17.0, -50.0, -53.0, 43.0, 15.0, -49.0, 49.0, -25.0, 11.0, -127.0, -64.0, -20.0, -50.0, -33.0, -2.0, -28.0, -46.0, -31.0, -36.0, -124.0, -56.0, -28.0, -29.0, -73.0, -42.0, -53.0, -96.0, -5.0, 45.0, 29.0, 11.0, 19.0, -27.0, 48.0, 47.0, -35.0, 44.0, 26.0, -56.0, 21.0, 46.0, -44.0, 8.0, -59.0], "episode_lengths": [17, 29, 5, 22, 76, 63, 38, 37, 23, 22, 46, 70, 17, 6, 35, 38, 24, 17, 44, 38, 10, 18, 6, 18, 18, 36, 33, 29, 17, 16, 45, 81, 27, 12, 13, 87, 59, 9, 14, 36, 13, 26, 49, 92, 190, 6, 18, 44, 16, 19, 24, 38, 7, 7, 17, 4, 29, 29, 75, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7513143458756699, "mean_inference_ms": 2.2817722989691913, "mean_action_processing_ms": 0.09952817721999747, "mean_env_wait_ms": 0.2088990046606306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04352887471516927, "StateBufferConnector_ms": 0.007342894872029622, "ViewRequirementAgentConnector_ms": 0.15389521916707358}, "num_episodes": 28, "episode_return_max": 49.0, "episode_return_min": -127.0, "episode_return_mean": -20.933333333333334}, "env_runner_results": {"episode_reward_max": 49.0, "episode_reward_min": -127.0, "episode_reward_mean": -20.933333333333334, "episode_len_mean": 33.2, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 1992, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.0, -20.0, -32.0, 35.0, -45.0, 32.0, -23.0, 42.0, 10.0, -27.0, -69.0, -57.0, -50.0, -49.0, -20.0, -77.0, 17.0, -50.0, -53.0, 43.0, 15.0, -49.0, 49.0, -25.0, 11.0, -127.0, -64.0, -20.0, -50.0, -33.0, -2.0, -28.0, -46.0, -31.0, -36.0, -124.0, -56.0, -28.0, -29.0, -73.0, -42.0, -53.0, -96.0, -5.0, 45.0, 29.0, 11.0, 19.0, -27.0, 48.0, 47.0, -35.0, 44.0, 26.0, -56.0, 21.0, 46.0, -44.0, 8.0, -59.0], "episode_lengths": [17, 29, 5, 22, 76, 63, 38, 37, 23, 22, 46, 70, 17, 6, 35, 38, 24, 17, 44, 38, 10, 18, 6, 18, 18, 36, 33, 29, 17, 16, 45, 81, 27, 12, 13, 87, 59, 9, 14, 36, 13, 26, 49, 92, 190, 6, 18, 44, 16, 19, 24, 38, 7, 7, 17, 4, 29, 29, 75, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7513143458756699, "mean_inference_ms": 2.2817722989691913, "mean_action_processing_ms": 0.09952817721999747, "mean_env_wait_ms": 0.2088990046606306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04352887471516927, "StateBufferConnector_ms": 0.007342894872029622, "ViewRequirementAgentConnector_ms": 0.15389521916707358}, "num_episodes": 28, "episode_return_max": 49.0, "episode_return_min": -127.0, "episode_return_mean": -20.933333333333334}, "episode_reward_max": 49.0, "episode_reward_min": -127.0, "episode_reward_mean": -20.933333333333334, "episode_len_mean": 33.2, "episodes_this_iter": 28, "episodes_timesteps_total": 1992, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.0, -20.0, -32.0, 35.0, -45.0, 32.0, -23.0, 42.0, 10.0, -27.0, -69.0, -57.0, -50.0, -49.0, -20.0, -77.0, 17.0, -50.0, -53.0, 43.0, 15.0, -49.0, 49.0, -25.0, 11.0, -127.0, -64.0, -20.0, -50.0, -33.0, -2.0, -28.0, -46.0, -31.0, -36.0, -124.0, -56.0, -28.0, -29.0, -73.0, -42.0, -53.0, -96.0, -5.0, 45.0, 29.0, 11.0, 19.0, -27.0, 48.0, 47.0, -35.0, 44.0, 26.0, -56.0, 21.0, 46.0, -44.0, 8.0, -59.0], "episode_lengths": [17, 29, 5, 22, 76, 63, 38, 37, 23, 22, 46, 70, 17, 6, 35, 38, 24, 17, 44, 38, 10, 18, 6, 18, 18, 36, 33, 29, 17, 16, 45, 81, 27, 12, 13, 87, 59, 9, 14, 36, 13, 26, 49, 92, 190, 6, 18, 44, 16, 19, 24, 38, 7, 7, 17, 4, 29, 29, 75, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7513143458756699, "mean_inference_ms": 2.2817722989691913, "mean_action_processing_ms": 0.09952817721999747, "mean_env_wait_ms": 0.2088990046606306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04352887471516927, "StateBufferConnector_ms": 0.007342894872029622, "ViewRequirementAgentConnector_ms": 0.15389521916707358}, "num_episodes": 28, "episode_return_max": 49.0, "episode_return_min": -127.0, "episode_return_mean": -20.933333333333334, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 20.333406563519258, "num_env_steps_trained_throughput_per_sec": 650.6690100326163, "timesteps_total": 2000, "num_env_steps_sampled_lifetime": 2000, "num_agent_steps_sampled_lifetime": 2000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 2000, "timers": {"training_iteration_time_ms": 27499.286, "restore_workers_time_ms": 0.01, "training_step_time_ms": 47.905, "sample_time_ms": 19.212, "load_time_ms": 0.144, "load_throughput": 222251.578, "learn_time_ms": 13.036, "learn_throughput": 2454.684, "synch_weights_time_ms": 5.346}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "last_target_update_ts": 1501, "num_target_updates": 2}, "done": false, "episodes_total": 60, "training_iteration": 2, "trial_id": "default", "date": "2024-05-20_22-45-50", "timestamp": 1716270350, "time_this_iter_s": 49.195188999176025, "time_total_s": 55.01609706878662, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 55.01609706878662, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 60.34571428571428, "ram_util_percent": 51.55857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.637000322341919, "mean_q": 0.9330664873123169, "min_q": -10.412500381469727, "max_q": 31.653182983398438, "cur_lr": 0.0005}, "td_error": [0.9124050140380859, 1.0874223709106445, -5.422405242919922, 0.7119529247283936, -9.219161987304688, -1.5638999938964844, -0.34607887268066406, -3.587515354156494, -4.6999711990356445, 21.033235549926758, -2.310124158859253, 1.967900037765503, 1.0091493129730225, -0.27961254119873047, -0.48639726638793945, -2.685886859893799, 0.37807369232177734, -1.1645779609680176, 1.6531829833984375, -2.0866775512695312, -0.8496866226196289, 0.10066413879394531, 10.448123931884766, 3.960259437561035, 3.3096747398376465, 1.9734067916870117, -3.409285068511963, 4.6683783531188965, -5.004410743713379, 5.859225749969482, -3.1657791137695312, -0.49185895919799805], "mean_td_error": 0.3843664526939392, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 2000.0, "diff_num_grad_updates_vs_sampler_policy": 1999.0}}, "num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "last_target_update_ts": 2501, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": 49.0, "episode_reward_min": -134.0, "episode_reward_mean": -23.920454545454547, "episode_len_mean": 33.30681818181818, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 2931, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.0, -20.0, -32.0, 35.0, -45.0, 32.0, -23.0, 42.0, 10.0, -27.0, -69.0, -57.0, -50.0, -49.0, -20.0, -77.0, 17.0, -50.0, -53.0, 43.0, 15.0, -49.0, 49.0, -25.0, 11.0, -127.0, -64.0, -20.0, -50.0, -33.0, -2.0, -28.0, -46.0, -31.0, -36.0, -124.0, -56.0, -28.0, -29.0, -73.0, -42.0, -53.0, -96.0, -5.0, 45.0, 29.0, 11.0, 19.0, -27.0, 48.0, 47.0, -35.0, 44.0, 26.0, -56.0, 21.0, 46.0, -44.0, 8.0, -59.0, -35.0, -43.0, -134.0, -44.0, -14.0, -30.0, 42.0, 32.0, -34.0, -116.0, 27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0], "episode_lengths": [17, 29, 5, 22, 76, 63, 38, 37, 23, 22, 46, 70, 17, 6, 35, 38, 24, 17, 44, 38, 10, 18, 6, 18, 18, 36, 33, 29, 17, 16, 45, 81, 27, 12, 13, 87, 59, 9, 14, 36, 13, 26, 49, 92, 190, 6, 18, 44, 16, 19, 24, 38, 7, 7, 17, 4, 29, 29, 75, 38, 14, 18, 83, 29, 65, 13, 41, 21, 21, 113, 4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7787347150065581, "mean_inference_ms": 2.283382090509764, "mean_action_processing_ms": 0.09988529147366815, "mean_env_wait_ms": 0.21109415556302225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04742958328940652, "StateBufferConnector_ms": 0.008104064247824928, "ViewRequirementAgentConnector_ms": 0.1680802215229381}, "num_episodes": 28, "episode_return_max": 49.0, "episode_return_min": -134.0, "episode_return_mean": -23.920454545454547}, "env_runner_results": {"episode_reward_max": 49.0, "episode_reward_min": -134.0, "episode_reward_mean": -23.920454545454547, "episode_len_mean": 33.30681818181818, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 2931, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.0, -20.0, -32.0, 35.0, -45.0, 32.0, -23.0, 42.0, 10.0, -27.0, -69.0, -57.0, -50.0, -49.0, -20.0, -77.0, 17.0, -50.0, -53.0, 43.0, 15.0, -49.0, 49.0, -25.0, 11.0, -127.0, -64.0, -20.0, -50.0, -33.0, -2.0, -28.0, -46.0, -31.0, -36.0, -124.0, -56.0, -28.0, -29.0, -73.0, -42.0, -53.0, -96.0, -5.0, 45.0, 29.0, 11.0, 19.0, -27.0, 48.0, 47.0, -35.0, 44.0, 26.0, -56.0, 21.0, 46.0, -44.0, 8.0, -59.0, -35.0, -43.0, -134.0, -44.0, -14.0, -30.0, 42.0, 32.0, -34.0, -116.0, 27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0], "episode_lengths": [17, 29, 5, 22, 76, 63, 38, 37, 23, 22, 46, 70, 17, 6, 35, 38, 24, 17, 44, 38, 10, 18, 6, 18, 18, 36, 33, 29, 17, 16, 45, 81, 27, 12, 13, 87, 59, 9, 14, 36, 13, 26, 49, 92, 190, 6, 18, 44, 16, 19, 24, 38, 7, 7, 17, 4, 29, 29, 75, 38, 14, 18, 83, 29, 65, 13, 41, 21, 21, 113, 4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7787347150065581, "mean_inference_ms": 2.283382090509764, "mean_action_processing_ms": 0.09988529147366815, "mean_env_wait_ms": 0.21109415556302225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04742958328940652, "StateBufferConnector_ms": 0.008104064247824928, "ViewRequirementAgentConnector_ms": 0.1680802215229381}, "num_episodes": 28, "episode_return_max": 49.0, "episode_return_min": -134.0, "episode_return_mean": -23.920454545454547}, "episode_reward_max": 49.0, "episode_reward_min": -134.0, "episode_reward_mean": -23.920454545454547, "episode_len_mean": 33.30681818181818, "episodes_this_iter": 28, "episodes_timesteps_total": 2931, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.0, -20.0, -32.0, 35.0, -45.0, 32.0, -23.0, 42.0, 10.0, -27.0, -69.0, -57.0, -50.0, -49.0, -20.0, -77.0, 17.0, -50.0, -53.0, 43.0, 15.0, -49.0, 49.0, -25.0, 11.0, -127.0, -64.0, -20.0, -50.0, -33.0, -2.0, -28.0, -46.0, -31.0, -36.0, -124.0, -56.0, -28.0, -29.0, -73.0, -42.0, -53.0, -96.0, -5.0, 45.0, 29.0, 11.0, 19.0, -27.0, 48.0, 47.0, -35.0, 44.0, 26.0, -56.0, 21.0, 46.0, -44.0, 8.0, -59.0, -35.0, -43.0, -134.0, -44.0, -14.0, -30.0, 42.0, 32.0, -34.0, -116.0, 27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0], "episode_lengths": [17, 29, 5, 22, 76, 63, 38, 37, 23, 22, 46, 70, 17, 6, 35, 38, 24, 17, 44, 38, 10, 18, 6, 18, 18, 36, 33, 29, 17, 16, 45, 81, 27, 12, 13, 87, 59, 9, 14, 36, 13, 26, 49, 92, 190, 6, 18, 44, 16, 19, 24, 38, 7, 7, 17, 4, 29, 29, 75, 38, 14, 18, 83, 29, 65, 13, 41, 21, 21, 113, 4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7787347150065581, "mean_inference_ms": 2.283382090509764, "mean_action_processing_ms": 0.09988529147366815, "mean_env_wait_ms": 0.21109415556302225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04742958328940652, "StateBufferConnector_ms": 0.008104064247824928, "ViewRequirementAgentConnector_ms": 0.1680802215229381}, "num_episodes": 28, "episode_return_max": 49.0, "episode_return_min": -134.0, "episode_return_mean": -23.920454545454547, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 20.2313131035316, "num_env_steps_trained_throughput_per_sec": 647.4020193130112, "timesteps_total": 3000, "num_env_steps_sampled_lifetime": 3000, "num_agent_steps_sampled_lifetime": 3000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 3000, "timers": {"training_iteration_time_ms": 34808.97, "restore_workers_time_ms": 0.008, "training_step_time_ms": 45.416, "sample_time_ms": 17.92, "load_time_ms": 0.145, "load_throughput": 220716.54, "learn_time_ms": 12.354, "learn_throughput": 2590.291, "synch_weights_time_ms": 5.178}, "counters": {"num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "last_target_update_ts": 2501, "num_target_updates": 4}, "done": false, "episodes_total": 88, "training_iteration": 3, "trial_id": "default", "date": "2024-05-20_22-46-40", "timestamp": 1716270400, "time_this_iter_s": 49.443288803100586, "time_total_s": 104.4593858718872, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 104.4593858718872, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 60.889999999999986, "ram_util_percent": 51.49000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1705867052078247, "mean_q": 5.774161338806152, "min_q": -19.486499786376953, "max_q": 33.835121154785156, "cur_lr": 0.0005}, "td_error": [-0.24508380889892578, -3.034605026245117, -1.29156494140625, 2.6682918071746826, -6.207730293273926, -0.6649622917175293, 4.708831787109375, 1.2933154106140137, 1.4743905067443848, 1.3343772888183594, -29.72430419921875, -4.905796527862549, 2.0603928565979004, 3.8351211547851562, -2.8343505859375, -0.9520315527915955, 3.920370101928711, 0.8615269660949707, -2.3866615295410156, -3.3738603591918945, 8.710128784179688, -2.506342887878418, 1.1206655502319336, -2.9501285552978516, -3.2466001510620117, 1.4491958618164062, -1.970174789428711, -1.7283620834350586, 1.525991439819336, -9.6785888671875, -1.7455463409423828, 23.31774139404297], "mean_td_error": -0.6614484786987305, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 3000.0, "diff_num_grad_updates_vs_sampler_policy": 2999.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "last_target_update_ts": 3501, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": 60.0, "episode_reward_min": -134.0, "episode_reward_mean": -20.91, "episode_len_mean": 36.15, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 3615, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-57.0, -50.0, -49.0, -20.0, -77.0, 17.0, -50.0, -53.0, 43.0, 15.0, -49.0, 49.0, -25.0, 11.0, -127.0, -64.0, -20.0, -50.0, -33.0, -2.0, -28.0, -46.0, -31.0, -36.0, -124.0, -56.0, -28.0, -29.0, -73.0, -42.0, -53.0, -96.0, -5.0, 45.0, 29.0, 11.0, 19.0, -27.0, 48.0, 47.0, -35.0, 44.0, 26.0, -56.0, 21.0, 46.0, -44.0, 8.0, -59.0, -35.0, -43.0, -134.0, -44.0, -14.0, -30.0, 42.0, 32.0, -34.0, -116.0, 27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0], "episode_lengths": [70, 17, 6, 35, 38, 24, 17, 44, 38, 10, 18, 6, 18, 18, 36, 33, 29, 17, 16, 45, 81, 27, 12, 13, 87, 59, 9, 14, 36, 13, 26, 49, 92, 190, 6, 18, 44, 16, 19, 24, 38, 7, 7, 17, 4, 29, 29, 75, 38, 14, 18, 83, 29, 65, 13, 41, 21, 21, 113, 4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8050412089895991, "mean_inference_ms": 2.2865299305959095, "mean_action_processing_ms": 0.10015829901961953, "mean_env_wait_ms": 0.213420678012859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052405595779418945, "StateBufferConnector_ms": 0.008775949478149414, "ViewRequirementAgentConnector_ms": 0.17953872680664062}, "num_episodes": 23, "episode_return_max": 60.0, "episode_return_min": -134.0, "episode_return_mean": -20.91}, "env_runner_results": {"episode_reward_max": 60.0, "episode_reward_min": -134.0, "episode_reward_mean": -20.91, "episode_len_mean": 36.15, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 3615, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-57.0, -50.0, -49.0, -20.0, -77.0, 17.0, -50.0, -53.0, 43.0, 15.0, -49.0, 49.0, -25.0, 11.0, -127.0, -64.0, -20.0, -50.0, -33.0, -2.0, -28.0, -46.0, -31.0, -36.0, -124.0, -56.0, -28.0, -29.0, -73.0, -42.0, -53.0, -96.0, -5.0, 45.0, 29.0, 11.0, 19.0, -27.0, 48.0, 47.0, -35.0, 44.0, 26.0, -56.0, 21.0, 46.0, -44.0, 8.0, -59.0, -35.0, -43.0, -134.0, -44.0, -14.0, -30.0, 42.0, 32.0, -34.0, -116.0, 27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0], "episode_lengths": [70, 17, 6, 35, 38, 24, 17, 44, 38, 10, 18, 6, 18, 18, 36, 33, 29, 17, 16, 45, 81, 27, 12, 13, 87, 59, 9, 14, 36, 13, 26, 49, 92, 190, 6, 18, 44, 16, 19, 24, 38, 7, 7, 17, 4, 29, 29, 75, 38, 14, 18, 83, 29, 65, 13, 41, 21, 21, 113, 4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8050412089895991, "mean_inference_ms": 2.2865299305959095, "mean_action_processing_ms": 0.10015829901961953, "mean_env_wait_ms": 0.213420678012859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052405595779418945, "StateBufferConnector_ms": 0.008775949478149414, "ViewRequirementAgentConnector_ms": 0.17953872680664062}, "num_episodes": 23, "episode_return_max": 60.0, "episode_return_min": -134.0, "episode_return_mean": -20.91}, "episode_reward_max": 60.0, "episode_reward_min": -134.0, "episode_reward_mean": -20.91, "episode_len_mean": 36.15, "episodes_this_iter": 23, "episodes_timesteps_total": 3615, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-57.0, -50.0, -49.0, -20.0, -77.0, 17.0, -50.0, -53.0, 43.0, 15.0, -49.0, 49.0, -25.0, 11.0, -127.0, -64.0, -20.0, -50.0, -33.0, -2.0, -28.0, -46.0, -31.0, -36.0, -124.0, -56.0, -28.0, -29.0, -73.0, -42.0, -53.0, -96.0, -5.0, 45.0, 29.0, 11.0, 19.0, -27.0, 48.0, 47.0, -35.0, 44.0, 26.0, -56.0, 21.0, 46.0, -44.0, 8.0, -59.0, -35.0, -43.0, -134.0, -44.0, -14.0, -30.0, 42.0, 32.0, -34.0, -116.0, 27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0], "episode_lengths": [70, 17, 6, 35, 38, 24, 17, 44, 38, 10, 18, 6, 18, 18, 36, 33, 29, 17, 16, 45, 81, 27, 12, 13, 87, 59, 9, 14, 36, 13, 26, 49, 92, 190, 6, 18, 44, 16, 19, 24, 38, 7, 7, 17, 4, 29, 29, 75, 38, 14, 18, 83, 29, 65, 13, 41, 21, 21, 113, 4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8050412089895991, "mean_inference_ms": 2.2865299305959095, "mean_action_processing_ms": 0.10015829901961953, "mean_env_wait_ms": 0.213420678012859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052405595779418945, "StateBufferConnector_ms": 0.008775949478149414, "ViewRequirementAgentConnector_ms": 0.17953872680664062}, "num_episodes": 23, "episode_return_max": 60.0, "episode_return_min": -134.0, "episode_return_mean": -20.91, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 20.22760092408455, "num_env_steps_trained_throughput_per_sec": 647.2832295707055, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 38466.08, "restore_workers_time_ms": 0.008, "training_step_time_ms": 45.537, "sample_time_ms": 18.274, "load_time_ms": 0.136, "load_throughput": 235345.832, "learn_time_ms": 12.03, "learn_throughput": 2660.047, "synch_weights_time_ms": 5.262}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "last_target_update_ts": 3501, "num_target_updates": 6}, "done": false, "episodes_total": 111, "training_iteration": 4, "trial_id": "default", "date": "2024-05-20_22-47-29", "timestamp": 1716270449, "time_this_iter_s": 49.4521381855011, "time_total_s": 153.9115240573883, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 153.9115240573883, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 60.92285714285715, "ram_util_percent": 51.54428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.936895489692688, "mean_q": 6.205618858337402, "min_q": -28.66027069091797, "max_q": 39.15101623535156, "cur_lr": 0.0005}, "td_error": [-10.7357816696167, 0.664574146270752, 1.9959564208984375, -0.4188547134399414, -0.6517114639282227, 1.5680580139160156, 1.3397293090820312, 1.443852424621582, -4.06280517578125, 21.250186920166016, -0.017002105712890625, 2.8871917724609375, -1.0532817840576172, -0.45864295959472656, 1.5715703964233398, -5.463542461395264, -0.9728622436523438, -2.2062015533447266, -3.555177688598633, -16.325897216796875, -0.2580127716064453, 2.363292694091797, 2.8871917724609375, -4.911380767822266, 3.320791244506836, 0.9202518463134766, -2.689441680908203, 2.068589210510254, -1.8861608505249023, 7.873950958251953, -0.6566228866577148, 2.720500946044922], "mean_td_error": -0.0452403724193573, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 4000.0, "diff_num_grad_updates_vs_sampler_policy": 3999.0}}, "num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "last_target_update_ts": 4501, "num_target_updates": 8}, "sampler_results": {"episode_reward_max": 60.0, "episode_reward_min": -134.0, "episode_reward_mean": -14.13, "episode_len_mean": 37.25, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 3725, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, -28.0, -29.0, -73.0, -42.0, -53.0, -96.0, -5.0, 45.0, 29.0, 11.0, 19.0, -27.0, 48.0, 47.0, -35.0, 44.0, 26.0, -56.0, 21.0, 46.0, -44.0, 8.0, -59.0, -35.0, -43.0, -134.0, -44.0, -14.0, -30.0, 42.0, 32.0, -34.0, -116.0, 27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0], "episode_lengths": [59, 9, 14, 36, 13, 26, 49, 92, 190, 6, 18, 44, 16, 19, 24, 38, 7, 7, 17, 4, 29, 29, 75, 38, 14, 18, 83, 29, 65, 13, 41, 21, 21, 113, 4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8428319158225349, "mean_inference_ms": 2.2935304888619132, "mean_action_processing_ms": 0.10074462566253194, "mean_env_wait_ms": 0.21734470484451893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06003522872924805, "StateBufferConnector_ms": 0.009673357009887695, "ViewRequirementAgentConnector_ms": 0.1983785629272461}, "num_episodes": 25, "episode_return_max": 60.0, "episode_return_min": -134.0, "episode_return_mean": -14.13}, "env_runner_results": {"episode_reward_max": 60.0, "episode_reward_min": -134.0, "episode_reward_mean": -14.13, "episode_len_mean": 37.25, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 3725, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, -28.0, -29.0, -73.0, -42.0, -53.0, -96.0, -5.0, 45.0, 29.0, 11.0, 19.0, -27.0, 48.0, 47.0, -35.0, 44.0, 26.0, -56.0, 21.0, 46.0, -44.0, 8.0, -59.0, -35.0, -43.0, -134.0, -44.0, -14.0, -30.0, 42.0, 32.0, -34.0, -116.0, 27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0], "episode_lengths": [59, 9, 14, 36, 13, 26, 49, 92, 190, 6, 18, 44, 16, 19, 24, 38, 7, 7, 17, 4, 29, 29, 75, 38, 14, 18, 83, 29, 65, 13, 41, 21, 21, 113, 4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8428319158225349, "mean_inference_ms": 2.2935304888619132, "mean_action_processing_ms": 0.10074462566253194, "mean_env_wait_ms": 0.21734470484451893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06003522872924805, "StateBufferConnector_ms": 0.009673357009887695, "ViewRequirementAgentConnector_ms": 0.1983785629272461}, "num_episodes": 25, "episode_return_max": 60.0, "episode_return_min": -134.0, "episode_return_mean": -14.13}, "episode_reward_max": 60.0, "episode_reward_min": -134.0, "episode_reward_mean": -14.13, "episode_len_mean": 37.25, "episodes_this_iter": 25, "episodes_timesteps_total": 3725, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.0, -28.0, -29.0, -73.0, -42.0, -53.0, -96.0, -5.0, 45.0, 29.0, 11.0, 19.0, -27.0, 48.0, 47.0, -35.0, 44.0, 26.0, -56.0, 21.0, 46.0, -44.0, 8.0, -59.0, -35.0, -43.0, -134.0, -44.0, -14.0, -30.0, 42.0, 32.0, -34.0, -116.0, 27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0], "episode_lengths": [59, 9, 14, 36, 13, 26, 49, 92, 190, 6, 18, 44, 16, 19, 24, 38, 7, 7, 17, 4, 29, 29, 75, 38, 14, 18, 83, 29, 65, 13, 41, 21, 21, 113, 4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8428319158225349, "mean_inference_ms": 2.2935304888619132, "mean_action_processing_ms": 0.10074462566253194, "mean_env_wait_ms": 0.21734470484451893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06003522872924805, "StateBufferConnector_ms": 0.009673357009887695, "ViewRequirementAgentConnector_ms": 0.1983785629272461}, "num_episodes": 25, "episode_return_max": 60.0, "episode_return_min": -134.0, "episode_return_mean": -14.13, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.788526279654924, "num_env_steps_trained_throughput_per_sec": 633.2328409489576, "timesteps_total": 5000, "num_env_steps_sampled_lifetime": 5000, "num_agent_steps_sampled_lifetime": 5000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 5000, "timers": {"training_iteration_time_ms": 40879.732, "restore_workers_time_ms": 0.013, "training_step_time_ms": 48.305, "sample_time_ms": 18.845, "load_time_ms": 0.146, "load_throughput": 219633.003, "learn_time_ms": 13.444, "learn_throughput": 2380.329, "synch_weights_time_ms": 5.578}, "counters": {"num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "last_target_update_ts": 4501, "num_target_updates": 8}, "done": false, "episodes_total": 136, "training_iteration": 5, "trial_id": "default", "date": "2024-05-20_22-48-20", "timestamp": 1716270500, "time_this_iter_s": 50.550009965896606, "time_total_s": 204.4615340232849, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 204.4615340232849, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 61.79305555555556, "ram_util_percent": 51.71805555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6960045099258423, "mean_q": 14.255183219909668, "min_q": -17.919843673706055, "max_q": 34.82731628417969, "cur_lr": 0.0005}, "td_error": [0.6048622131347656, -1.5369701385498047, -2.926992416381836, -2.1011734008789062, -6.650523662567139, -2.6452693939208984, -8.804738998413086, 0.5502529144287109, -9.91171646118164, -0.2707386016845703, -0.8610544204711914, 2.824338912963867, -1.1045236587524414, 0.8134860992431641, -2.504269599914551, 0.6041793823242188, -2.104473114013672, 4.24363899230957, -15.919137001037598, -0.9260225296020508, -0.5265970230102539, -0.35015201568603516, 0.6415824890136719, -0.44007253646850586, -0.6612701416015625, -1.9326000213623047, -1.0881500244140625, -5.264011383056641, 2.4701576232910156, 6.305504322052002, -35.96399688720703, 0.461639404296875], "mean_td_error": -2.6554629802703857, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 5000.0, "diff_num_grad_updates_vs_sampler_policy": 4999.0}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "last_target_update_ts": 5501, "num_target_updates": 10}, "sampler_results": {"episode_reward_max": 74.0, "episode_reward_min": -134.0, "episode_reward_mean": -8.21, "episode_len_mean": 41.77, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4177, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0, -44.0, 8.0, -59.0, -35.0, -43.0, -134.0, -44.0, -14.0, -30.0, 42.0, 32.0, -34.0, -116.0, 27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0], "episode_lengths": [29, 29, 75, 38, 14, 18, 83, 29, 65, 13, 41, 21, 21, 113, 4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8585505052383192, "mean_inference_ms": 2.298945463799346, "mean_action_processing_ms": 0.10108147653908801, "mean_env_wait_ms": 0.21971196460947198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06149172782897949, "StateBufferConnector_ms": 0.009558916091918945, "ViewRequirementAgentConnector_ms": 0.20058894157409668}, "num_episodes": 20, "episode_return_max": 74.0, "episode_return_min": -134.0, "episode_return_mean": -8.21}, "env_runner_results": {"episode_reward_max": 74.0, "episode_reward_min": -134.0, "episode_reward_mean": -8.21, "episode_len_mean": 41.77, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4177, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0, -44.0, 8.0, -59.0, -35.0, -43.0, -134.0, -44.0, -14.0, -30.0, 42.0, 32.0, -34.0, -116.0, 27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0], "episode_lengths": [29, 29, 75, 38, 14, 18, 83, 29, 65, 13, 41, 21, 21, 113, 4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8585505052383192, "mean_inference_ms": 2.298945463799346, "mean_action_processing_ms": 0.10108147653908801, "mean_env_wait_ms": 0.21971196460947198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06149172782897949, "StateBufferConnector_ms": 0.009558916091918945, "ViewRequirementAgentConnector_ms": 0.20058894157409668}, "num_episodes": 20, "episode_return_max": 74.0, "episode_return_min": -134.0, "episode_return_mean": -8.21}, "episode_reward_max": 74.0, "episode_reward_min": -134.0, "episode_reward_mean": -8.21, "episode_len_mean": 41.77, "episodes_this_iter": 20, "episodes_timesteps_total": 4177, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.0, -44.0, 8.0, -59.0, -35.0, -43.0, -134.0, -44.0, -14.0, -30.0, 42.0, 32.0, -34.0, -116.0, 27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0], "episode_lengths": [29, 29, 75, 38, 14, 18, 83, 29, 65, 13, 41, 21, 21, 113, 4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8585505052383192, "mean_inference_ms": 2.298945463799346, "mean_action_processing_ms": 0.10108147653908801, "mean_env_wait_ms": 0.21971196460947198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06149172782897949, "StateBufferConnector_ms": 0.009558916091918945, "ViewRequirementAgentConnector_ms": 0.20058894157409668}, "num_episodes": 20, "episode_return_max": 74.0, "episode_return_min": -134.0, "episode_return_mean": -8.21, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 20.103526713038317, "num_env_steps_trained_throughput_per_sec": 643.3128548172261, "timesteps_total": 6000, "num_env_steps_sampled_lifetime": 6000, "num_agent_steps_sampled_lifetime": 6000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 6000, "timers": {"training_iteration_time_ms": 42356.864, "restore_workers_time_ms": 0.009, "training_step_time_ms": 49.163, "sample_time_ms": 18.99, "load_time_ms": 0.157, "load_throughput": 203329.386, "learn_time_ms": 13.599, "learn_throughput": 2353.062, "synch_weights_time_ms": 5.519}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "last_target_update_ts": 5501, "num_target_updates": 10}, "done": false, "episodes_total": 156, "training_iteration": 6, "trial_id": "default", "date": "2024-05-20_22-49-10", "timestamp": 1716270550, "time_this_iter_s": 49.75776696205139, "time_total_s": 254.2193009853363, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 254.2193009853363, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 60.77887323943661, "ram_util_percent": 51.3605633802817}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9650188088417053, "mean_q": 12.746829986572266, "min_q": -21.635181427001953, "max_q": 48.185028076171875, "cur_lr": 0.0005}, "td_error": [8.364818572998047, -6.865038871765137, 1.2862253189086914, -1.3496761322021484, 1.835052490234375, 14.459833145141602, -6.287830352783203, 1.5656256675720215, 0.36162757873535156, 4.61083984375, -0.9831514358520508, -3.524907350540161, 0.322296142578125, 33.27112579345703, 0.23727130889892578, -1.3363828659057617, 1.1680450439453125, -8.44729232788086, -3.5499038696289062, -4.739545822143555, -1.421544075012207, 2.828104019165039, 6.475009918212891, 0.3362922668457031, -6.060665130615234, -1.1871681213378906, -4.662941932678223, 0.44091129302978516, 1.0377492904663086, 17.809907913208008, -1.8208045959472656, -0.46264076232910156], "mean_td_error": 1.365976095199585, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 6000.0, "diff_num_grad_updates_vs_sampler_policy": 5999.0}}, "num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "last_target_update_ts": 6501, "num_target_updates": 12}, "sampler_results": {"episode_reward_max": 325.0, "episode_reward_min": -116.0, "episode_reward_mean": 0.52, "episode_len_mean": 46.12, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 4612, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-116.0, 27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0], "episode_lengths": [113, 4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8666883695215541, "mean_inference_ms": 2.3033957035587775, "mean_action_processing_ms": 0.10129544656334924, "mean_env_wait_ms": 0.2213294811701104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06275486946105957, "StateBufferConnector_ms": 0.009614229202270508, "ViewRequirementAgentConnector_ms": 0.20106244087219238}, "num_episodes": 13, "episode_return_max": 325.0, "episode_return_min": -116.0, "episode_return_mean": 0.52}, "env_runner_results": {"episode_reward_max": 325.0, "episode_reward_min": -116.0, "episode_reward_mean": 0.52, "episode_len_mean": 46.12, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 4612, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-116.0, 27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0], "episode_lengths": [113, 4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8666883695215541, "mean_inference_ms": 2.3033957035587775, "mean_action_processing_ms": 0.10129544656334924, "mean_env_wait_ms": 0.2213294811701104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06275486946105957, "StateBufferConnector_ms": 0.009614229202270508, "ViewRequirementAgentConnector_ms": 0.20106244087219238}, "num_episodes": 13, "episode_return_max": 325.0, "episode_return_min": -116.0, "episode_return_mean": 0.52}, "episode_reward_max": 325.0, "episode_reward_min": -116.0, "episode_reward_mean": 0.52, "episode_len_mean": 46.12, "episodes_this_iter": 13, "episodes_timesteps_total": 4612, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-116.0, 27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0], "episode_lengths": [113, 4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8666883695215541, "mean_inference_ms": 2.3033957035587775, "mean_action_processing_ms": 0.10129544656334924, "mean_env_wait_ms": 0.2213294811701104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06275486946105957, "StateBufferConnector_ms": 0.009614229202270508, "ViewRequirementAgentConnector_ms": 0.20106244087219238}, "num_episodes": 13, "episode_return_max": 325.0, "episode_return_min": -116.0, "episode_return_mean": 0.52, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.79748835565833, "num_env_steps_trained_throughput_per_sec": 633.5196273810666, "timesteps_total": 7000, "num_env_steps_sampled_lifetime": 7000, "num_agent_steps_sampled_lifetime": 7000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 7000, "timers": {"training_iteration_time_ms": 43521.808, "restore_workers_time_ms": 0.011, "training_step_time_ms": 53.189, "sample_time_ms": 21.038, "load_time_ms": 0.154, "load_throughput": 208283.253, "learn_time_ms": 14.209, "learn_throughput": 2252.07, "synch_weights_time_ms": 6.172}, "counters": {"num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "last_target_update_ts": 6501, "num_target_updates": 12}, "done": false, "episodes_total": 169, "training_iteration": 7, "trial_id": "default", "date": "2024-05-20_22-50-00", "timestamp": 1716270600, "time_this_iter_s": 50.52649903297424, "time_total_s": 304.74580001831055, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 304.74580001831055, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 61.56527777777779, "ram_util_percent": 51.13611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0368425846099854, "mean_q": 15.676424026489258, "min_q": -23.663576126098633, "max_q": 44.300174713134766, "cur_lr": 0.0005}, "td_error": [0.9257965087890625, -1.837310791015625, 0.7394657135009766, -0.2539205551147461, 0.29492950439453125, 0.40163421630859375, -0.09180259704589844, -2.9490699768066406, -0.39009857177734375, 1.5569920539855957, 0.7021093368530273, 8.724175453186035, 1.1125288009643555, -0.1686868667602539, -1.142425537109375, 2.423586845397949, -5.116106033325195, 6.336423873901367, 0.8715972900390625, 1.5503501892089844, 2.851114273071289, -0.5022506713867188, -1.1625862121582031, 1.6412105560302734, -7.398414611816406, 0.8627834320068359, -1.142425537109375, 2.060281753540039, 0.752598762512207, 0.41570472717285156, -1.1882352828979492, -0.4909839630126953], "mean_td_error": 0.3246552050113678, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 7000.0, "diff_num_grad_updates_vs_sampler_policy": 6999.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "last_target_update_ts": 7501, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": 325.0, "episode_reward_min": -97.0, "episode_reward_mean": 4.58, "episode_len_mean": 49.46, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 4946, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0], "episode_lengths": [4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8672991430812478, "mean_inference_ms": 2.3039523015637924, "mean_action_processing_ms": 0.10131725474591569, "mean_env_wait_ms": 0.22148635942438513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0626974105834961, "StateBufferConnector_ms": 0.009604692459106445, "ViewRequirementAgentConnector_ms": 0.20087909698486328}, "num_episodes": 1, "episode_return_max": 325.0, "episode_return_min": -97.0, "episode_return_mean": 4.58}, "env_runner_results": {"episode_reward_max": 325.0, "episode_reward_min": -97.0, "episode_reward_mean": 4.58, "episode_len_mean": 49.46, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 4946, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0], "episode_lengths": [4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8672991430812478, "mean_inference_ms": 2.3039523015637924, "mean_action_processing_ms": 0.10131725474591569, "mean_env_wait_ms": 0.22148635942438513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0626974105834961, "StateBufferConnector_ms": 0.009604692459106445, "ViewRequirementAgentConnector_ms": 0.20087909698486328}, "num_episodes": 1, "episode_return_max": 325.0, "episode_return_min": -97.0, "episode_return_mean": 4.58}, "episode_reward_max": 325.0, "episode_reward_min": -97.0, "episode_reward_mean": 4.58, "episode_len_mean": 49.46, "episodes_this_iter": 1, "episodes_timesteps_total": 4946, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.0, -39.0, -45.0, -31.0, -39.0, 25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0], "episode_lengths": [4, 4, 52, 6, 4, 14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8672991430812478, "mean_inference_ms": 2.3039523015637924, "mean_action_processing_ms": 0.10131725474591569, "mean_env_wait_ms": 0.22148635942438513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0626974105834961, "StateBufferConnector_ms": 0.009604692459106445, "ViewRequirementAgentConnector_ms": 0.20087909698486328}, "num_episodes": 1, "episode_return_max": 325.0, "episode_return_min": -97.0, "episode_return_mean": 4.58, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.871627575473255, "num_env_steps_trained_throughput_per_sec": 603.8920824151442, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 44705.283, "restore_workers_time_ms": 0.01, "training_step_time_ms": 61.995, "sample_time_ms": 23.264, "load_time_ms": 0.23, "load_throughput": 139331.182, "learn_time_ms": 17.642, "learn_throughput": 1813.873, "synch_weights_time_ms": 7.048}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "last_target_update_ts": 7501, "num_target_updates": 14}, "done": false, "episodes_total": 170, "training_iteration": 8, "trial_id": "default", "date": "2024-05-20_22-50-53", "timestamp": 1716270653, "time_this_iter_s": 53.012139081954956, "time_total_s": 357.7579391002655, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 357.7579391002655, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 64.89999999999999, "ram_util_percent": 51.34533333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.14455246925354, "mean_q": 19.27423667907715, "min_q": -22.13542938232422, "max_q": 49.348514556884766, "cur_lr": 0.0005}, "td_error": [-0.4673023223876953, 5.171298980712891, -0.7945537567138672, -9.80014419555664, -2.128406524658203, -0.3948783874511719, 0.9670867919921875, 0.21201133728027344, -0.4522552490234375, 1.7170944213867188, 1.0820674896240234, -0.045475006103515625, -3.0911788940429688, 6.847333908081055, 0.5092849731445312, -0.399749755859375, 7.864570617675781, -0.6675605773925781, -0.7950553894042969, -0.14371490478515625, 0.43361473083496094, -2.727670669555664, 2.7053613662719727, -0.5715365409851074, -0.14371490478515625, 0.07545661926269531, -0.13518333435058594, 0.5043869018554688, -0.6675605773925781, -0.2355060577392578, -0.6675586700439453, -1.7255783081054688], "mean_td_error": 0.06359325349330902, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 8000.0, "diff_num_grad_updates_vs_sampler_policy": 7999.0}}, "num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "last_target_update_ts": 8501, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": 588.0, "episode_reward_min": -97.0, "episode_reward_mean": 19.22, "episode_len_mean": 64.86, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 6486, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0], "episode_lengths": [14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.870660050932771, "mean_inference_ms": 2.3073490515823605, "mean_action_processing_ms": 0.10145246586339979, "mean_env_wait_ms": 0.22238345302718265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06355524063110352, "StateBufferConnector_ms": 0.009459257125854492, "ViewRequirementAgentConnector_ms": 0.2009744644165039}, "num_episodes": 5, "episode_return_max": 588.0, "episode_return_min": -97.0, "episode_return_mean": 19.22}, "env_runner_results": {"episode_reward_max": 588.0, "episode_reward_min": -97.0, "episode_reward_mean": 19.22, "episode_len_mean": 64.86, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 6486, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0], "episode_lengths": [14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.870660050932771, "mean_inference_ms": 2.3073490515823605, "mean_action_processing_ms": 0.10145246586339979, "mean_env_wait_ms": 0.22238345302718265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06355524063110352, "StateBufferConnector_ms": 0.009459257125854492, "ViewRequirementAgentConnector_ms": 0.2009744644165039}, "num_episodes": 5, "episode_return_max": 588.0, "episode_return_min": -97.0, "episode_return_mean": 19.22}, "episode_reward_max": 588.0, "episode_reward_min": -97.0, "episode_reward_mean": 19.22, "episode_len_mean": 64.86, "episodes_this_iter": 5, "episodes_timesteps_total": 6486, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0], "episode_lengths": [14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.870660050932771, "mean_inference_ms": 2.3073490515823605, "mean_action_processing_ms": 0.10145246586339979, "mean_env_wait_ms": 0.22238345302718265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06355524063110352, "StateBufferConnector_ms": 0.009459257125854492, "ViewRequirementAgentConnector_ms": 0.2009744644165039}, "num_episodes": 5, "episode_return_max": 588.0, "episode_return_min": -97.0, "episode_return_mean": 19.22, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.09452686363324, "num_env_steps_trained_throughput_per_sec": 611.0248596362637, "timesteps_total": 9000, "num_env_steps_sampled_lifetime": 9000, "num_agent_steps_sampled_lifetime": 9000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 9000, "timers": {"training_iteration_time_ms": 45557.034, "restore_workers_time_ms": 0.01, "training_step_time_ms": 46.56, "sample_time_ms": 18.175, "load_time_ms": 0.15, "load_throughput": 213213.23, "learn_time_ms": 12.589, "learn_throughput": 2541.805, "synch_weights_time_ms": 5.312}, "counters": {"num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "last_target_update_ts": 8501, "num_target_updates": 16}, "done": false, "episodes_total": 175, "training_iteration": 9, "trial_id": "default", "date": "2024-05-20_22-51-46", "timestamp": 1716270706, "time_this_iter_s": 52.38587188720703, "time_total_s": 410.14381098747253, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 410.14381098747253, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 64.41733333333333, "ram_util_percent": 50.95866666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0126101970672607, "mean_q": 25.411895751953125, "min_q": -25.873228073120117, "max_q": 49.92454147338867, "cur_lr": 0.0005}, "td_error": [0.4524059295654297, 0.4734001159667969, 1.6523284912109375, 2.6905345916748047, 41.30467224121094, 1.1349525451660156, 0.4386711120605469, 0.089202880859375, -0.123779296875, -1.4923343658447266, -2.561983108520508, -0.07545852661132812, -0.33185768127441406, 0.07191276550292969, 0.4386711120605469, 0.7515735626220703, 1.3096923828125, 0.64398193359375, -1.8806781768798828, -0.19229507446289062, 0.6642055511474609, -2.973484992980957, 0.7179470062255859, 0.4524059295654297, -3.191770553588867, -1.0594921112060547, -3.8361740112304688, 0.5319252014160156, 4.126771926879883, 0.10172271728515625, 0.8462028503417969, 1.9029159545898438], "mean_td_error": 1.3461496829986572, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 9000.0, "diff_num_grad_updates_vs_sampler_policy": 8999.0}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "last_target_update_ts": 9501, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": 588.0, "episode_reward_min": -97.0, "episode_reward_mean": 19.22, "episode_len_mean": 64.86, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 6486, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0], "episode_lengths": [14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.870660050932771, "mean_inference_ms": 2.3073490515823605, "mean_action_processing_ms": 0.10145246586339979, "mean_env_wait_ms": 0.22238345302718265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06355524063110352, "StateBufferConnector_ms": 0.009459257125854492, "ViewRequirementAgentConnector_ms": 0.2009744644165039}, "num_episodes": 0, "episode_return_max": 588.0, "episode_return_min": -97.0, "episode_return_mean": 19.22}, "env_runner_results": {"episode_reward_max": 588.0, "episode_reward_min": -97.0, "episode_reward_mean": 19.22, "episode_len_mean": 64.86, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 6486, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0], "episode_lengths": [14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.870660050932771, "mean_inference_ms": 2.3073490515823605, "mean_action_processing_ms": 0.10145246586339979, "mean_env_wait_ms": 0.22238345302718265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06355524063110352, "StateBufferConnector_ms": 0.009459257125854492, "ViewRequirementAgentConnector_ms": 0.2009744644165039}, "num_episodes": 0, "episode_return_max": 588.0, "episode_return_min": -97.0, "episode_return_mean": 19.22}, "episode_reward_max": 588.0, "episode_reward_min": -97.0, "episode_reward_mean": 19.22, "episode_len_mean": 64.86, "episodes_this_iter": 0, "episodes_timesteps_total": 6486, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0], "episode_lengths": [14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.870660050932771, "mean_inference_ms": 2.3073490515823605, "mean_action_processing_ms": 0.10145246586339979, "mean_env_wait_ms": 0.22238345302718265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06355524063110352, "StateBufferConnector_ms": 0.009459257125854492, "ViewRequirementAgentConnector_ms": 0.2009744644165039}, "num_episodes": 0, "episode_return_max": 588.0, "episode_return_min": -97.0, "episode_return_mean": 19.22, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.81866096081805, "num_env_steps_trained_throughput_per_sec": 634.1971507461776, "timesteps_total": 10000, "num_env_steps_sampled_lifetime": 10000, "num_agent_steps_sampled_lifetime": 10000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 10000, "timers": {"training_iteration_time_ms": 46047.081, "restore_workers_time_ms": 0.009, "training_step_time_ms": 46.489, "sample_time_ms": 18.311, "load_time_ms": 0.144, "load_throughput": 222990.078, "learn_time_ms": 12.558, "learn_throughput": 2548.16, "synch_weights_time_ms": 5.306}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "last_target_update_ts": 9501, "num_target_updates": 18}, "done": false, "episodes_total": 175, "training_iteration": 10, "trial_id": "default", "date": "2024-05-20_22-52-36", "timestamp": 1716270756, "time_this_iter_s": 50.47416281700134, "time_total_s": 460.6179738044739, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 460.6179738044739, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 62.22394366197182, "ram_util_percent": 50.953521126760556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6708373427391052, "mean_q": 26.481138229370117, "min_q": 4.413504600524902, "max_q": 51.40342712402344, "cur_lr": 0.0005}, "td_error": [0.6555156707763672, -0.18662071228027344, 2.0936241149902344, -0.12483024597167969, 3.0288734436035156, 0.24675369262695312, -0.18662071228027344, -1.554147720336914, 0.053699493408203125, 14.310742378234863, -0.029241561889648438, 1.4034271240234375, 3.0409069061279297, -0.323089599609375, -1.5682182312011719, -2.663738250732422, 0.7432975769042969, 0.037273406982421875, -0.7149410247802734, -8.193305969238281, 1.820383071899414, 0.12563514709472656, 0.6689682006835938, 1.0532779693603516, -1.173868179321289, -0.9714927673339844, -1.0851764678955078, 0.5339736938476562, -0.04306602478027344, 0.21467208862304688, -0.052459716796875, -0.8094959259033203], "mean_td_error": 0.3234597146511078, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 10000.0, "diff_num_grad_updates_vs_sampler_policy": 9999.0}}, "num_env_steps_sampled": 11000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 320000, "last_target_update_ts": 10501, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": 588.0, "episode_reward_min": -97.0, "episode_reward_mean": 19.22, "episode_len_mean": 64.86, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 6486, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0], "episode_lengths": [14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.870660050932771, "mean_inference_ms": 2.3073490515823605, "mean_action_processing_ms": 0.10145246586339979, "mean_env_wait_ms": 0.22238345302718265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06355524063110352, "StateBufferConnector_ms": 0.009459257125854492, "ViewRequirementAgentConnector_ms": 0.2009744644165039}, "num_episodes": 0, "episode_return_max": 588.0, "episode_return_min": -97.0, "episode_return_mean": 19.22}, "env_runner_results": {"episode_reward_max": 588.0, "episode_reward_min": -97.0, "episode_reward_mean": 19.22, "episode_len_mean": 64.86, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 6486, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0], "episode_lengths": [14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.870660050932771, "mean_inference_ms": 2.3073490515823605, "mean_action_processing_ms": 0.10145246586339979, "mean_env_wait_ms": 0.22238345302718265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06355524063110352, "StateBufferConnector_ms": 0.009459257125854492, "ViewRequirementAgentConnector_ms": 0.2009744644165039}, "num_episodes": 0, "episode_return_max": 588.0, "episode_return_min": -97.0, "episode_return_mean": 19.22}, "episode_reward_max": 588.0, "episode_reward_min": -97.0, "episode_reward_mean": 19.22, "episode_len_mean": 64.86, "episodes_this_iter": 0, "episodes_timesteps_total": 6486, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.0, -37.0, -94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0], "episode_lengths": [14, 6, 69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.870660050932771, "mean_inference_ms": 2.3073490515823605, "mean_action_processing_ms": 0.10145246586339979, "mean_env_wait_ms": 0.22238345302718265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06355524063110352, "StateBufferConnector_ms": 0.009459257125854492, "ViewRequirementAgentConnector_ms": 0.2009744644165039}, "num_episodes": 0, "episode_return_max": 588.0, "episode_return_min": -97.0, "episode_return_mean": 19.22, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 11000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.23530916071702, "num_env_steps_trained_throughput_per_sec": 615.5298931429446, "timesteps_total": 11000, "num_env_steps_sampled_lifetime": 11000, "num_agent_steps_sampled_lifetime": 11000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 11000, "timers": {"training_iteration_time_ms": 50664.013, "restore_workers_time_ms": 0.009, "training_step_time_ms": 55.932, "sample_time_ms": 21.027, "load_time_ms": 0.162, "load_throughput": 197002.39, "learn_time_ms": 16.327, "learn_throughput": 1959.978, "synch_weights_time_ms": 6.592}, "counters": {"num_env_steps_sampled": 11000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 320000, "last_target_update_ts": 10501, "num_target_updates": 20}, "done": false, "episodes_total": 175, "training_iteration": 11, "trial_id": "default", "date": "2024-05-20_22-53-28", "timestamp": 1716270808, "time_this_iter_s": 52.00320816040039, "time_total_s": 512.6211819648743, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 512.6211819648743, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 63.722972972972975, "ram_util_percent": 51.067567567567565}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.689627766609192, "mean_q": 21.35718536376953, "min_q": -33.60107421875, "max_q": 39.35557174682617, "cur_lr": 0.0005}, "td_error": [-3.60107421875, 0.26723289489746094, -1.4923439025878906, -1.1433591842651367, -0.7746467590332031, 1.4009056091308594, -21.039627075195312, 10.269733428955078, -0.6171588897705078, 0.30068206787109375, -0.9266128540039062, -0.7147846221923828, -0.7147846221923828, -1.3054790496826172, 6.612201690673828, -0.5711326599121094, -0.1319732666015625, 1.5134849548339844, -1.8578968048095703, 10.986557960510254, -0.8575496673583984, -0.44626617431640625, -0.5701675415039062, 0.8837718963623047, 0.186065673828125, 0.6808586120605469, 1.1249542236328125, -0.14562416076660156, -0.45401763916015625, 0.48455238342285156, 33.161033630371094, -0.022098541259765625], "mean_td_error": 0.9526699185371399, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 11000.0, "diff_num_grad_updates_vs_sampler_policy": 10999.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 352000, "last_target_update_ts": 11501, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": 2272.0, "episode_reward_min": -97.0, "episode_reward_mean": 43.2, "episode_len_mean": 89.04, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 8904, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0], "episode_lengths": [69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8720833528712453, "mean_inference_ms": 2.3087333741016067, "mean_action_processing_ms": 0.1015111014082069, "mean_env_wait_ms": 0.2228204678132807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06367826461791992, "StateBufferConnector_ms": 0.009427070617675781, "ViewRequirementAgentConnector_ms": 0.20071768760681152}, "num_episodes": 2, "episode_return_max": 2272.0, "episode_return_min": -97.0, "episode_return_mean": 43.2}, "env_runner_results": {"episode_reward_max": 2272.0, "episode_reward_min": -97.0, "episode_reward_mean": 43.2, "episode_len_mean": 89.04, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 8904, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0], "episode_lengths": [69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8720833528712453, "mean_inference_ms": 2.3087333741016067, "mean_action_processing_ms": 0.1015111014082069, "mean_env_wait_ms": 0.2228204678132807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06367826461791992, "StateBufferConnector_ms": 0.009427070617675781, "ViewRequirementAgentConnector_ms": 0.20071768760681152}, "num_episodes": 2, "episode_return_max": 2272.0, "episode_return_min": -97.0, "episode_return_mean": 43.2}, "episode_reward_max": 2272.0, "episode_reward_min": -97.0, "episode_reward_mean": 43.2, "episode_len_mean": 89.04, "episodes_this_iter": 2, "episodes_timesteps_total": 8904, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0], "episode_lengths": [69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8720833528712453, "mean_inference_ms": 2.3087333741016067, "mean_action_processing_ms": 0.1015111014082069, "mean_env_wait_ms": 0.2228204678132807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06367826461791992, "StateBufferConnector_ms": 0.009427070617675781, "ViewRequirementAgentConnector_ms": 0.20071768760681152}, "num_episodes": 2, "episode_return_max": 2272.0, "episode_return_min": -97.0, "episode_return_mean": 43.2, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 20.290033079209493, "num_env_steps_trained_throughput_per_sec": 649.2810585347038, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 50674.526, "restore_workers_time_ms": 0.008, "training_step_time_ms": 46.818, "sample_time_ms": 18.265, "load_time_ms": 0.159, "load_throughput": 201376.936, "learn_time_ms": 12.782, "learn_throughput": 2503.45, "synch_weights_time_ms": 5.327}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 352000, "last_target_update_ts": 11501, "num_target_updates": 22}, "done": false, "episodes_total": 177, "training_iteration": 12, "trial_id": "default", "date": "2024-05-20_22-54-18", "timestamp": 1716270858, "time_this_iter_s": 49.30376219749451, "time_total_s": 561.9249441623688, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 561.9249441623688, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 59.572857142857146, "ram_util_percent": 51.515714285714274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0462218523025513, "mean_q": 30.59385108947754, "min_q": 21.031661987304688, "max_q": 41.03893280029297, "cur_lr": 0.0005}, "td_error": [0.16579437255859375, 0.17069625854492188, -0.2148876190185547, 0.16678237915039062, -8.691518783569336, 0.7632713317871094, -1.9504871368408203, 0.13836669921875, -0.4535789489746094, -0.057117462158203125, -0.057117462158203125, 0.4156074523925781, 1.4902572631835938, -1.5441017150878906, 0.4512805938720703, 1.2323074340820312, 0.9097118377685547, -0.04073333740234375, 3.2683563232421875, 0.3820934295654297, 5.513826370239258, -6.399913787841797, 0.8188629150390625, -0.15053367614746094, -0.5442180633544922, -1.3609981536865234, 1.266672134399414, -0.2602806091308594, 1.1162166595458984, -0.4370613098144531, 0.3186683654785156, -0.8122940063476562], "mean_td_error": -0.13706469535827637, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 12000.0, "diff_num_grad_updates_vs_sampler_policy": 11999.0}}, "num_env_steps_sampled": 13000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 384000, "last_target_update_ts": 12501, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": 2272.0, "episode_reward_min": -97.0, "episode_reward_mean": 43.2, "episode_len_mean": 89.04, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 8904, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0], "episode_lengths": [69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8720833528712453, "mean_inference_ms": 2.3087333741016067, "mean_action_processing_ms": 0.1015111014082069, "mean_env_wait_ms": 0.2228204678132807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06367826461791992, "StateBufferConnector_ms": 0.009427070617675781, "ViewRequirementAgentConnector_ms": 0.20071768760681152}, "num_episodes": 0, "episode_return_max": 2272.0, "episode_return_min": -97.0, "episode_return_mean": 43.2}, "env_runner_results": {"episode_reward_max": 2272.0, "episode_reward_min": -97.0, "episode_reward_mean": 43.2, "episode_len_mean": 89.04, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 8904, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0], "episode_lengths": [69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8720833528712453, "mean_inference_ms": 2.3087333741016067, "mean_action_processing_ms": 0.1015111014082069, "mean_env_wait_ms": 0.2228204678132807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06367826461791992, "StateBufferConnector_ms": 0.009427070617675781, "ViewRequirementAgentConnector_ms": 0.20071768760681152}, "num_episodes": 0, "episode_return_max": 2272.0, "episode_return_min": -97.0, "episode_return_mean": 43.2}, "episode_reward_max": 2272.0, "episode_reward_min": -97.0, "episode_reward_mean": 43.2, "episode_len_mean": 89.04, "episodes_this_iter": 0, "episodes_timesteps_total": 8904, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0], "episode_lengths": [69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8720833528712453, "mean_inference_ms": 2.3087333741016067, "mean_action_processing_ms": 0.1015111014082069, "mean_env_wait_ms": 0.2228204678132807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06367826461791992, "StateBufferConnector_ms": 0.009427070617675781, "ViewRequirementAgentConnector_ms": 0.20071768760681152}, "num_episodes": 0, "episode_return_max": 2272.0, "episode_return_min": -97.0, "episode_return_mean": 43.2, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 13000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.344117572127438, "num_env_steps_trained_throughput_per_sec": 619.011762308078, "timesteps_total": 13000, "num_env_steps_sampled_lifetime": 13000, "num_agent_steps_sampled_lifetime": 13000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 13000, "timers": {"training_iteration_time_ms": 50901.223, "restore_workers_time_ms": 0.009, "training_step_time_ms": 51.978, "sample_time_ms": 19.607, "load_time_ms": 0.151, "load_throughput": 211933.883, "learn_time_ms": 14.593, "learn_throughput": 2192.817, "synch_weights_time_ms": 5.842}, "counters": {"num_env_steps_sampled": 13000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 384000, "last_target_update_ts": 12501, "num_target_updates": 24}, "done": false, "episodes_total": 177, "training_iteration": 13, "trial_id": "default", "date": "2024-05-20_22-55-09", "timestamp": 1716270909, "time_this_iter_s": 51.710357904434204, "time_total_s": 613.635302066803, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 613.635302066803, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 63.68108108108109, "ram_util_percent": 51.244594594594595}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2877345085144043, "mean_q": 32.61703872680664, "min_q": 16.018211364746094, "max_q": 42.74615478515625, "cur_lr": 0.0005}, "td_error": [1.3089027404785156, 0.049465179443359375, -2.5156402587890625, 0.15771102905273438, -2.8370132446289062, -0.2550373077392578, 8.047900199890137, 0.28751564025878906, 3.9399423599243164, 0.42446136474609375, -0.8936538696289062, -2.3590545654296875, -2.629434585571289, -0.2866992950439453, 0.18841171264648438, -0.6046409606933594, -2.8808975219726562, 0.06512069702148438, -0.24880409240722656, -1.555938720703125, -0.09300994873046875, -0.4182891845703125, -1.2186698913574219, -0.3418388366699219, -2.3788185119628906, 0.7072067260742188, 1.3831195831298828, -1.3671703338623047, -2.9164352416992188, -0.5222187042236328, -1.2275390625, -0.06820869445800781], "mean_td_error": -0.3456017076969147, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 13000.0, "diff_num_grad_updates_vs_sampler_policy": 12999.0}}, "num_env_steps_sampled": 14000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 416000, "last_target_update_ts": 13501, "num_target_updates": 26}, "sampler_results": {"episode_reward_max": 2272.0, "episode_reward_min": -97.0, "episode_reward_mean": 43.2, "episode_len_mean": 89.04, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 8904, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0], "episode_lengths": [69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8720833528712453, "mean_inference_ms": 2.3087333741016067, "mean_action_processing_ms": 0.1015111014082069, "mean_env_wait_ms": 0.2228204678132807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06367826461791992, "StateBufferConnector_ms": 0.009427070617675781, "ViewRequirementAgentConnector_ms": 0.20071768760681152}, "num_episodes": 0, "episode_return_max": 2272.0, "episode_return_min": -97.0, "episode_return_mean": 43.2}, "env_runner_results": {"episode_reward_max": 2272.0, "episode_reward_min": -97.0, "episode_reward_mean": 43.2, "episode_len_mean": 89.04, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 8904, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0], "episode_lengths": [69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8720833528712453, "mean_inference_ms": 2.3087333741016067, "mean_action_processing_ms": 0.1015111014082069, "mean_env_wait_ms": 0.2228204678132807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06367826461791992, "StateBufferConnector_ms": 0.009427070617675781, "ViewRequirementAgentConnector_ms": 0.20071768760681152}, "num_episodes": 0, "episode_return_max": 2272.0, "episode_return_min": -97.0, "episode_return_mean": 43.2}, "episode_reward_max": 2272.0, "episode_reward_min": -97.0, "episode_reward_mean": 43.2, "episode_len_mean": 89.04, "episodes_this_iter": 0, "episodes_timesteps_total": 8904, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-94.0, -70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0], "episode_lengths": [69, 99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8720833528712453, "mean_inference_ms": 2.3087333741016067, "mean_action_processing_ms": 0.1015111014082069, "mean_env_wait_ms": 0.2228204678132807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06367826461791992, "StateBufferConnector_ms": 0.009427070617675781, "ViewRequirementAgentConnector_ms": 0.20071768760681152}, "num_episodes": 0, "episode_return_max": 2272.0, "episode_return_min": -97.0, "episode_return_mean": 43.2, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 14000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.912926050837168, "num_env_steps_trained_throughput_per_sec": 637.2136336267894, "timesteps_total": 14000, "num_env_steps_sampled_lifetime": 14000, "num_agent_steps_sampled_lifetime": 14000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 14000, "timers": {"training_iteration_time_ms": 50979.347, "restore_workers_time_ms": 0.012, "training_step_time_ms": 50.725, "sample_time_ms": 20.24, "load_time_ms": 0.144, "load_throughput": 221957.546, "learn_time_ms": 13.712, "learn_throughput": 2333.807, "synch_weights_time_ms": 5.423}, "counters": {"num_env_steps_sampled": 14000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 416000, "last_target_update_ts": 13501, "num_target_updates": 26}, "done": false, "episodes_total": 177, "training_iteration": 14, "trial_id": "default", "date": "2024-05-20_22-56-00", "timestamp": 1716270960, "time_this_iter_s": 50.233132123947144, "time_total_s": 663.8684341907501, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 663.8684341907501, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 61.64507042253521, "ram_util_percent": 51.070422535211264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5557281970977783, "mean_q": 34.176795959472656, "min_q": 18.977018356323242, "max_q": 44.451507568359375, "cur_lr": 0.0005}, "td_error": [0.4952220916748047, 0.4500007629394531, 0.2028179168701172, 0.7159996032714844, 1.5599250793457031, 0.8567581176757812, -9.606866836547852, 0.7268486022949219, 0.3435401916503906, 0.4787769317626953, 0.16046142578125, 4.886810302734375, -0.062744140625, -0.20211029052734375, 2.9766845703125, 0.331878662109375, 0.7085094451904297, 0.36844635009765625, 2.6886844635009766, 2.092426300048828, 1.5807971954345703, 0.4249610900878906, 0.04468536376953125, 0.10700798034667969, -2.504436492919922, 0.45691680908203125, 1.3740615844726562, 0.32391929626464844, 0.2028179168701172, -0.1954498291015625, 0.5743808746337891, -0.7380256652832031], "mean_td_error": 0.3694908022880554, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 14000.0, "diff_num_grad_updates_vs_sampler_policy": 13999.0}}, "num_env_steps_sampled": 15000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 448000, "last_target_update_ts": 14501, "num_target_updates": 28}, "sampler_results": {"episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 70.67, "episode_len_mean": 116.63, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 11663, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0], "episode_lengths": [99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8728748295700697, "mean_inference_ms": 2.3095532470831217, "mean_action_processing_ms": 0.10154818139149152, "mean_env_wait_ms": 0.2230737993529997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06395483016967773, "StateBufferConnector_ms": 0.009423017501831055, "ViewRequirementAgentConnector_ms": 0.20038723945617676}, "num_episodes": 1, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 70.67}, "env_runner_results": {"episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 70.67, "episode_len_mean": 116.63, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 11663, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0], "episode_lengths": [99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8728748295700697, "mean_inference_ms": 2.3095532470831217, "mean_action_processing_ms": 0.10154818139149152, "mean_env_wait_ms": 0.2230737993529997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06395483016967773, "StateBufferConnector_ms": 0.009423017501831055, "ViewRequirementAgentConnector_ms": 0.20038723945617676}, "num_episodes": 1, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 70.67}, "episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 70.67, "episode_len_mean": 116.63, "episodes_this_iter": 1, "episodes_timesteps_total": 11663, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-70.0, 29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0], "episode_lengths": [99, 6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8728748295700697, "mean_inference_ms": 2.3095532470831217, "mean_action_processing_ms": 0.10154818139149152, "mean_env_wait_ms": 0.2230737993529997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06395483016967773, "StateBufferConnector_ms": 0.009423017501831055, "ViewRequirementAgentConnector_ms": 0.20038723945617676}, "num_episodes": 1, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 70.67, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 15000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 17.996896408288798, "num_env_steps_trained_throughput_per_sec": 575.9006850652415, "timesteps_total": 15000, "num_env_steps_sampled_lifetime": 15000, "num_agent_steps_sampled_lifetime": 15000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 15000, "timers": {"training_iteration_time_ms": 51482.427, "restore_workers_time_ms": 0.009, "training_step_time_ms": 53.936, "sample_time_ms": 20.634, "load_time_ms": 0.179, "load_throughput": 179171.977, "learn_time_ms": 15.736, "learn_throughput": 2033.602, "synch_weights_time_ms": 5.877}, "counters": {"num_env_steps_sampled": 15000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 448000, "last_target_update_ts": 14501, "num_target_updates": 28}, "done": false, "episodes_total": 178, "training_iteration": 15, "trial_id": "default", "date": "2024-05-20_22-56-55", "timestamp": 1716271015, "time_this_iter_s": 55.58396911621094, "time_total_s": 719.4524033069611, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 719.4524033069611, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 65.19873417721517, "ram_util_percent": 52.5253164556962}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7947522401809692, "mean_q": 34.011085510253906, "min_q": -33.09845733642578, "max_q": 53.79727554321289, "cur_lr": 0.0005}, "td_error": [0.11550140380859375, 1.2473793029785156, -3.6974716186523438, 0.2684669494628906, -0.341552734375, 0.6171455383300781, 0.6794967651367188, -0.17301177978515625, -3.0984573364257812, -0.355926513671875, 4.675703048706055, -0.7073822021484375, 0.014659881591796875, -2.9112091064453125, 1.8793220520019531, 0.6164894104003906, -0.9337863922119141, -0.11314201354980469, 0.3564033508300781, -2.9112091064453125, 0.6959762573242188, 4.180753707885742, 1.1678810119628906, -0.24492645263671875, -11.839277267456055, -1.5291099548339844, 1.000885009765625, 13.71579360961914, 0.37259674072265625, -0.50872802734375, 0.11568450927734375, 9.558544158935547], "mean_td_error": 0.37229663133621216, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 15000.0, "diff_num_grad_updates_vs_sampler_policy": 14999.0}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 480000, "last_target_update_ts": 15501, "num_target_updates": 30}, "sampler_results": {"episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 78.21, "episode_len_mean": 123.51, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 12351, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0], "episode_lengths": [6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8736737498045944, "mean_inference_ms": 2.3104014935647075, "mean_action_processing_ms": 0.10158471268584257, "mean_env_wait_ms": 0.22333230446490404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06387186050415039, "StateBufferConnector_ms": 0.009434223175048828, "ViewRequirementAgentConnector_ms": 0.19998478889465332}, "num_episodes": 1, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 78.21}, "env_runner_results": {"episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 78.21, "episode_len_mean": 123.51, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 12351, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0], "episode_lengths": [6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8736737498045944, "mean_inference_ms": 2.3104014935647075, "mean_action_processing_ms": 0.10158471268584257, "mean_env_wait_ms": 0.22333230446490404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06387186050415039, "StateBufferConnector_ms": 0.009434223175048828, "ViewRequirementAgentConnector_ms": 0.19998478889465332}, "num_episodes": 1, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 78.21}, "episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 78.21, "episode_len_mean": 123.51, "episodes_this_iter": 1, "episodes_timesteps_total": 12351, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.0, -97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0], "episode_lengths": [6, 36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8736737498045944, "mean_inference_ms": 2.3104014935647075, "mean_action_processing_ms": 0.10158471268584257, "mean_env_wait_ms": 0.22333230446490404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06387186050415039, "StateBufferConnector_ms": 0.009434223175048828, "ViewRequirementAgentConnector_ms": 0.19998478889465332}, "num_episodes": 1, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 78.21, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.58421613699863, "num_env_steps_trained_throughput_per_sec": 626.6949163839562, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 51614.328, "restore_workers_time_ms": 0.009, "training_step_time_ms": 55.091, "sample_time_ms": 20.941, "load_time_ms": 0.181, "load_throughput": 176370.208, "learn_time_ms": 15.387, "learn_throughput": 2079.65, "synch_weights_time_ms": 6.562}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 480000, "last_target_update_ts": 15501, "num_target_updates": 30}, "done": false, "episodes_total": 179, "training_iteration": 16, "trial_id": "default", "date": "2024-05-20_22-57-46", "timestamp": 1716271066, "time_this_iter_s": 51.083441972732544, "time_total_s": 770.5358452796936, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 770.5358452796936, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 59.63972602739726, "ram_util_percent": 53.87945205479452}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.892536461353302, "mean_q": 38.6711540222168, "min_q": 12.152555465698242, "max_q": 57.516910552978516, "cur_lr": 0.0005}, "td_error": [1.8329811096191406, 0.4482231140136719, -0.493896484375, -2.180023193359375, -0.1762542724609375, 0.8842849731445312, 3.9850425720214844, 0.12142181396484375, -0.2992668151855469, -1.4753780364990234, -1.7046890258789062, 0.6256256103515625, -2.9713029861450195, -1.5279159545898438, 0.3878822326660156, 1.137054443359375, -0.0207672119140625, -1.7398262023925781, 0.5041694641113281, -0.3474464416503906, 0.28736114501953125, -5.290950775146484, -0.14377212524414062, -0.059955596923828125, 0.4482231140136719, 4.952615737915039, -0.3858489990234375, -4.53656005859375, 0.9242935180664062, 2.4063987731933594, 0.6396522521972656, -1.7047004699707031], "mean_td_error": -0.17104139924049377, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 16000.0, "diff_num_grad_updates_vs_sampler_policy": 15999.0}}, "num_env_steps_sampled": 17000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 512000, "last_target_update_ts": 16501, "num_target_updates": 32}, "sampler_results": {"episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 88.98, "episode_len_mean": 139.74, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 13974, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0], "episode_lengths": [36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8744603022838463, "mean_inference_ms": 2.3112083066707636, "mean_action_processing_ms": 0.10162045916888678, "mean_env_wait_ms": 0.22358810417197275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06387925148010254, "StateBufferConnector_ms": 0.009423017501831055, "ViewRequirementAgentConnector_ms": 0.20029568672180176}, "num_episodes": 1, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 88.98}, "env_runner_results": {"episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 88.98, "episode_len_mean": 139.74, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 13974, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0], "episode_lengths": [36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8744603022838463, "mean_inference_ms": 2.3112083066707636, "mean_action_processing_ms": 0.10162045916888678, "mean_env_wait_ms": 0.22358810417197275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06387925148010254, "StateBufferConnector_ms": 0.009423017501831055, "ViewRequirementAgentConnector_ms": 0.20029568672180176}, "num_episodes": 1, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 88.98}, "episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 88.98, "episode_len_mean": 139.74, "episodes_this_iter": 1, "episodes_timesteps_total": 13974, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0], "episode_lengths": [36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8744603022838463, "mean_inference_ms": 2.3112083066707636, "mean_action_processing_ms": 0.10162045916888678, "mean_env_wait_ms": 0.22358810417197275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06387925148010254, "StateBufferConnector_ms": 0.009423017501831055, "ViewRequirementAgentConnector_ms": 0.20029568672180176}, "num_episodes": 1, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 88.98, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 17000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 20.070184568912413, "num_env_steps_trained_throughput_per_sec": 642.2459062051972, "timesteps_total": 17000, "num_env_steps_sampled_lifetime": 17000, "num_agent_steps_sampled_lifetime": 17000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 17000, "timers": {"training_iteration_time_ms": 51545.698, "restore_workers_time_ms": 0.01, "training_step_time_ms": 47.099, "sample_time_ms": 18.5, "load_time_ms": 0.14, "load_throughput": 228806.219, "learn_time_ms": 12.786, "learn_throughput": 2502.685, "synch_weights_time_ms": 5.318}, "counters": {"num_env_steps_sampled": 17000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 512000, "last_target_update_ts": 16501, "num_target_updates": 32}, "done": false, "episodes_total": 180, "training_iteration": 17, "trial_id": "default", "date": "2024-05-20_22-58-36", "timestamp": 1716271116, "time_this_iter_s": 49.83981895446777, "time_total_s": 820.3756642341614, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 820.3756642341614, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 61.35633802816903, "ram_util_percent": 53.95633802816899}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5225701332092285, "mean_q": 41.00209426879883, "min_q": 27.145593643188477, "max_q": 59.715213775634766, "cur_lr": 0.0005}, "td_error": [-0.14908218383789062, -0.9434013366699219, -0.37781524658203125, -0.6811180114746094, -2.570079803466797, 0.6123428344726562, 0.27721405029296875, -0.7794380187988281, -0.2671699523925781, 1.0922431945800781, 0.18653106689453125, -3.3066539764404297, 0.47666168212890625, -2.7113037109375, -0.8378982543945312, 0.9241371154785156, -0.14908218383789062, -0.6503944396972656, 0.632568359375, -0.15906906127929688, 0.4505500793457031, 0.21253585815429688, 3.6780433654785156, -1.4706306457519531, 0.16751861572265625, 5.167385101318359, 0.6406097412109375, 0.5500812530517578, 0.12856674194335938, -1.4644279479980469, 0.6123504638671875, 0.12029647827148438], "mean_td_error": -0.018372774124145508, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 17000.0, "diff_num_grad_updates_vs_sampler_policy": 16999.0}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 544000, "last_target_update_ts": 17501, "num_target_updates": 34}, "sampler_results": {"episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 88.98, "episode_len_mean": 139.74, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 13974, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0], "episode_lengths": [36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8744603022838463, "mean_inference_ms": 2.3112083066707636, "mean_action_processing_ms": 0.10162045916888678, "mean_env_wait_ms": 0.22358810417197275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06387925148010254, "StateBufferConnector_ms": 0.009423017501831055, "ViewRequirementAgentConnector_ms": 0.20029568672180176}, "num_episodes": 0, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 88.98}, "env_runner_results": {"episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 88.98, "episode_len_mean": 139.74, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 13974, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0], "episode_lengths": [36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8744603022838463, "mean_inference_ms": 2.3112083066707636, "mean_action_processing_ms": 0.10162045916888678, "mean_env_wait_ms": 0.22358810417197275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06387925148010254, "StateBufferConnector_ms": 0.009423017501831055, "ViewRequirementAgentConnector_ms": 0.20029568672180176}, "num_episodes": 0, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 88.98}, "episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 88.98, "episode_len_mean": 139.74, "episodes_this_iter": 0, "episodes_timesteps_total": 13974, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0], "episode_lengths": [36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8744603022838463, "mean_inference_ms": 2.3112083066707636, "mean_action_processing_ms": 0.10162045916888678, "mean_env_wait_ms": 0.22358810417197275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06387925148010254, "StateBufferConnector_ms": 0.009423017501831055, "ViewRequirementAgentConnector_ms": 0.20029568672180176}, "num_episodes": 0, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 88.98, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.959473119141357, "num_env_steps_trained_throughput_per_sec": 638.7031398125234, "timesteps_total": 18000, "num_env_steps_sampled_lifetime": 18000, "num_agent_steps_sampled_lifetime": 18000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 51256.89, "restore_workers_time_ms": 0.008, "training_step_time_ms": 47.973, "sample_time_ms": 18.673, "load_time_ms": 0.149, "load_throughput": 214165.834, "learn_time_ms": 13.457, "learn_throughput": 2377.997, "synch_weights_time_ms": 5.389}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 544000, "last_target_update_ts": 17501, "num_target_updates": 34}, "done": false, "episodes_total": 180, "training_iteration": 18, "trial_id": "default", "date": "2024-05-20_22-59-26", "timestamp": 1716271166, "time_this_iter_s": 50.11744689941406, "time_total_s": 870.4931111335754, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 870.4931111335754, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 61.77605633802818, "ram_util_percent": 53.60845070422534}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5785664916038513, "mean_q": 38.21965026855469, "min_q": -35.21905517578125, "max_q": 64.48625946044922, "cur_lr": 0.0005}, "td_error": [0.163238525390625, -3.0875892639160156, -0.6046028137207031, -3.5815658569335938, -0.05292510986328125, 0.2790260314941406, -0.6046028137207031, 0.6676826477050781, -0.16330337524414062, 0.5529060363769531, 0.46185302734375, 0.4798851013183594, -0.5039596557617188, -0.1303253173828125, -0.38135528564453125, -1.3624191284179688, -5.21905517578125, 3.379131317138672, 1.3012466430664062, -0.15388107299804688, -0.16771316528320312, -2.938098907470703, -0.6399917602539062, -17.659927368164062, 0.211639404296875, 0.46855926513671875, -3.254016876220703, 0.8158035278320312, 0.051868438720703125, -0.07082366943359375, 2.4382705688476562, 0.014438629150390625], "mean_td_error": -0.9153314828872681, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 18000.0, "diff_num_grad_updates_vs_sampler_policy": 17999.0}}, "num_env_steps_sampled": 19000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 576000, "last_target_update_ts": 18501, "num_target_updates": 36}, "sampler_results": {"episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 88.98, "episode_len_mean": 139.74, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 13974, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0], "episode_lengths": [36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8744603022838463, "mean_inference_ms": 2.3112083066707636, "mean_action_processing_ms": 0.10162045916888678, "mean_env_wait_ms": 0.22358810417197275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06387925148010254, "StateBufferConnector_ms": 0.009423017501831055, "ViewRequirementAgentConnector_ms": 0.20029568672180176}, "num_episodes": 0, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 88.98}, "env_runner_results": {"episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 88.98, "episode_len_mean": 139.74, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 13974, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0], "episode_lengths": [36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8744603022838463, "mean_inference_ms": 2.3112083066707636, "mean_action_processing_ms": 0.10162045916888678, "mean_env_wait_ms": 0.22358810417197275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06387925148010254, "StateBufferConnector_ms": 0.009423017501831055, "ViewRequirementAgentConnector_ms": 0.20029568672180176}, "num_episodes": 0, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 88.98}, "episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 88.98, "episode_len_mean": 139.74, "episodes_this_iter": 0, "episodes_timesteps_total": 13974, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0], "episode_lengths": [36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8744603022838463, "mean_inference_ms": 2.3112083066707636, "mean_action_processing_ms": 0.10162045916888678, "mean_env_wait_ms": 0.22358810417197275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06387925148010254, "StateBufferConnector_ms": 0.009423017501831055, "ViewRequirementAgentConnector_ms": 0.20029568672180176}, "num_episodes": 0, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 88.98, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 19000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.76452352849924, "num_env_steps_trained_throughput_per_sec": 600.4647529119757, "timesteps_total": 19000, "num_env_steps_sampled_lifetime": 19000, "num_agent_steps_sampled_lifetime": 19000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 19000, "timers": {"training_iteration_time_ms": 51348.992, "restore_workers_time_ms": 0.018, "training_step_time_ms": 52.535, "sample_time_ms": 20.595, "load_time_ms": 0.154, "load_throughput": 207286.066, "learn_time_ms": 14.111, "learn_throughput": 2267.766, "synch_weights_time_ms": 6.085}, "counters": {"num_env_steps_sampled": 19000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 576000, "last_target_update_ts": 18501, "num_target_updates": 36}, "done": false, "episodes_total": 180, "training_iteration": 19, "trial_id": "default", "date": "2024-05-20_23-00-20", "timestamp": 1716271220, "time_this_iter_s": 53.30630588531494, "time_total_s": 923.7994170188904, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 923.7994170188904, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 64.27499999999999, "ram_util_percent": 54.831578947368406}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.28939151763916, "mean_q": 42.664154052734375, "min_q": 24.1842041015625, "max_q": 58.08598709106445, "cur_lr": 0.0005}, "td_error": [-7.027248382568359, 3.9195098876953125, -1.1595458984375, -1.2557373046875, -4.6699981689453125, -0.2721099853515625, -0.29126739501953125, -0.117919921875, -0.39775848388671875, -0.10657501220703125, -0.5561408996582031, -0.5529136657714844, 0.8778610229492188, 4.978878021240234, -0.4058418273925781, -0.994140625, -1.0952415466308594, -1.806976318359375, -0.117919921875, -7.209980010986328, -0.2865409851074219, -1.1222496032714844, -0.117919921875, -3.090524673461914, 0.14708709716796875, 0.0107269287109375, -1.9115409851074219, -2.3704757690429688, -0.5854759216308594, 0.32106781005859375, 0.2636833190917969, 0.8905296325683594], "mean_td_error": -0.8160218596458435, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 19000.0, "diff_num_grad_updates_vs_sampler_policy": 18999.0}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 608000, "last_target_update_ts": 19501, "num_target_updates": 38}, "sampler_results": {"episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 88.98, "episode_len_mean": 139.74, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 13974, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0], "episode_lengths": [36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8744603022838463, "mean_inference_ms": 2.3112083066707636, "mean_action_processing_ms": 0.10162045916888678, "mean_env_wait_ms": 0.22358810417197275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06387925148010254, "StateBufferConnector_ms": 0.009423017501831055, "ViewRequirementAgentConnector_ms": 0.20029568672180176}, "num_episodes": 0, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 88.98}, "env_runner_results": {"episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 88.98, "episode_len_mean": 139.74, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 13974, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0], "episode_lengths": [36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8744603022838463, "mean_inference_ms": 2.3112083066707636, "mean_action_processing_ms": 0.10162045916888678, "mean_env_wait_ms": 0.22358810417197275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06387925148010254, "StateBufferConnector_ms": 0.009423017501831055, "ViewRequirementAgentConnector_ms": 0.20029568672180176}, "num_episodes": 0, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 88.98}, "episode_reward_max": 2653.0, "episode_reward_min": -97.0, "episode_reward_mean": 88.98, "episode_len_mean": 139.74, "episodes_this_iter": 0, "episodes_timesteps_total": 13974, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-97.0, -13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0], "episode_lengths": [36, 72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8744603022838463, "mean_inference_ms": 2.3112083066707636, "mean_action_processing_ms": 0.10162045916888678, "mean_env_wait_ms": 0.22358810417197275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06387925148010254, "StateBufferConnector_ms": 0.009423017501831055, "ViewRequirementAgentConnector_ms": 0.20029568672180176}, "num_episodes": 0, "episode_return_max": 2653.0, "episode_return_min": -97.0, "episode_return_mean": 88.98, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.768331382958493, "num_env_steps_trained_throughput_per_sec": 632.5866042546718, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 51361.839, "restore_workers_time_ms": 0.008, "training_step_time_ms": 48.339, "sample_time_ms": 18.757, "load_time_ms": 0.151, "load_throughput": 211933.883, "learn_time_ms": 13.261, "learn_throughput": 2413.081, "synch_weights_time_ms": 5.331}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 608000, "last_target_update_ts": 19501, "num_target_updates": 38}, "done": false, "episodes_total": 180, "training_iteration": 20, "trial_id": "default", "date": "2024-05-20_23-01-10", "timestamp": 1716271270, "time_this_iter_s": 50.604806900024414, "time_total_s": 974.4042239189148, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 974.4042239189148, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 61.92638888888889, "ram_util_percent": 54.461111111111116}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5210469961166382, "mean_q": 44.68455123901367, "min_q": 21.584043502807617, "max_q": 59.9301872253418, "cur_lr": 0.0005}, "td_error": [-0.178619384765625, 4.202323913574219, 1.9715156555175781, 1.2900733947753906, -1.1929435729980469, -0.4659461975097656, 2.0446739196777344, -0.6029701232910156, -0.9031028747558594, 1.3040084838867188, 0.7846565246582031, 1.1359443664550781, -0.011474609375, 0.1359710693359375, -0.906280517578125, -0.06011199951171875, -0.9898109436035156, -0.5803604125976562, 4.202323913574219, -0.15984725952148438, 4.928985595703125, 0.23636627197265625, -0.4453315734863281, 1.3040084838867188, -3.687685012817383, -0.4741783142089844, -2.0066490173339844, 0.5244827270507812, -0.12964248657226562, -0.5577201843261719, -0.41339874267578125, -2.2507972717285156], "mean_td_error": 0.2515144944190979, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 20000.0, "diff_num_grad_updates_vs_sampler_policy": 19999.0}}, "num_env_steps_sampled": 21000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 640000, "last_target_update_ts": 20501, "num_target_updates": 40}, "sampler_results": {"episode_reward_max": 3901.0, "episode_reward_min": -65.0, "episode_reward_mean": 128.96, "episode_len_mean": 179.36, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 17936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0], "episode_lengths": [72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8752540079843465, "mean_inference_ms": 2.311990794608536, "mean_action_processing_ms": 0.10165674269999242, "mean_env_wait_ms": 0.22386160968021737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06376457214355469, "StateBufferConnector_ms": 0.0094451904296875, "ViewRequirementAgentConnector_ms": 0.20014286041259766}, "num_episodes": 1, "episode_return_max": 3901.0, "episode_return_min": -65.0, "episode_return_mean": 128.96}, "env_runner_results": {"episode_reward_max": 3901.0, "episode_reward_min": -65.0, "episode_reward_mean": 128.96, "episode_len_mean": 179.36, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 17936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0], "episode_lengths": [72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8752540079843465, "mean_inference_ms": 2.311990794608536, "mean_action_processing_ms": 0.10165674269999242, "mean_env_wait_ms": 0.22386160968021737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06376457214355469, "StateBufferConnector_ms": 0.0094451904296875, "ViewRequirementAgentConnector_ms": 0.20014286041259766}, "num_episodes": 1, "episode_return_max": 3901.0, "episode_return_min": -65.0, "episode_return_mean": 128.96}, "episode_reward_max": 3901.0, "episode_reward_min": -65.0, "episode_reward_mean": 128.96, "episode_len_mean": 179.36, "episodes_this_iter": 1, "episodes_timesteps_total": 17936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0], "episode_lengths": [72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8752540079843465, "mean_inference_ms": 2.311990794608536, "mean_action_processing_ms": 0.10165674269999242, "mean_env_wait_ms": 0.22386160968021737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06376457214355469, "StateBufferConnector_ms": 0.0094451904296875, "ViewRequirementAgentConnector_ms": 0.20014286041259766}, "num_episodes": 1, "episode_return_max": 3901.0, "episode_return_min": -65.0, "episode_return_mean": 128.96, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 21000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 20.127492038040007, "num_env_steps_trained_throughput_per_sec": 644.0797452172802, "timesteps_total": 21000, "num_env_steps_sampled_lifetime": 21000, "num_agent_steps_sampled_lifetime": 21000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 21000, "timers": {"training_iteration_time_ms": 51131.395, "restore_workers_time_ms": 0.011, "training_step_time_ms": 55.089, "sample_time_ms": 21.939, "load_time_ms": 0.161, "load_throughput": 198988.477, "learn_time_ms": 14.912, "learn_throughput": 2145.952, "synch_weights_time_ms": 6.159}, "counters": {"num_env_steps_sampled": 21000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 640000, "last_target_update_ts": 20501, "num_target_updates": 40}, "done": false, "episodes_total": 181, "training_iteration": 21, "trial_id": "default", "date": "2024-05-20_23-02-00", "timestamp": 1716271320, "time_this_iter_s": 49.70205807685852, "time_total_s": 1024.1062819957733, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1024.1062819957733, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 60.97428571428571, "ram_util_percent": 54.675714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.453263521194458, "mean_q": 44.219974517822266, "min_q": -12.85713005065918, "max_q": 53.99462890625, "cur_lr": 0.0005}, "td_error": [-0.15919876098632812, 0.9090003967285156, -0.6118812561035156, 0.117156982421875, -0.16302490234375, -0.7582244873046875, -0.9973335266113281, 1.8877525329589844, -0.39178466796875, 0.4177894592285156, -0.3610954284667969, -0.3818244934082031, -0.19663619995117188, -0.041858673095703125, 1.5353775024414062, -0.4620246887207031, 17.14286994934082, -0.3461036682128906, -0.3610954284667969, -0.22951507568359375, 0.4177894592285156, 0.3400154113769531, 0.13043212890625, 22.349807739257812, 0.9194908142089844, 0.4177894592285156, 0.4177894592285156, -0.6416816711425781, -0.041858673095703125, 0.6081161499023438, -0.5453758239746094, -0.34609222412109375], "mean_td_error": 1.2679553031921387, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 21000.0, "diff_num_grad_updates_vs_sampler_policy": 20999.0}}, "num_env_steps_sampled": 22000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 672000, "last_target_update_ts": 21501, "num_target_updates": 42}, "sampler_results": {"episode_reward_max": 3901.0, "episode_reward_min": -65.0, "episode_reward_mean": 128.96, "episode_len_mean": 179.36, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 17936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0], "episode_lengths": [72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8752540079843465, "mean_inference_ms": 2.311990794608536, "mean_action_processing_ms": 0.10165674269999242, "mean_env_wait_ms": 0.22386160968021737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06376457214355469, "StateBufferConnector_ms": 0.0094451904296875, "ViewRequirementAgentConnector_ms": 0.20014286041259766}, "num_episodes": 0, "episode_return_max": 3901.0, "episode_return_min": -65.0, "episode_return_mean": 128.96}, "env_runner_results": {"episode_reward_max": 3901.0, "episode_reward_min": -65.0, "episode_reward_mean": 128.96, "episode_len_mean": 179.36, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 17936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0], "episode_lengths": [72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8752540079843465, "mean_inference_ms": 2.311990794608536, "mean_action_processing_ms": 0.10165674269999242, "mean_env_wait_ms": 0.22386160968021737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06376457214355469, "StateBufferConnector_ms": 0.0094451904296875, "ViewRequirementAgentConnector_ms": 0.20014286041259766}, "num_episodes": 0, "episode_return_max": 3901.0, "episode_return_min": -65.0, "episode_return_mean": 128.96}, "episode_reward_max": 3901.0, "episode_reward_min": -65.0, "episode_reward_mean": 128.96, "episode_len_mean": 179.36, "episodes_this_iter": 0, "episodes_timesteps_total": 17936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0], "episode_lengths": [72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8752540079843465, "mean_inference_ms": 2.311990794608536, "mean_action_processing_ms": 0.10165674269999242, "mean_env_wait_ms": 0.22386160968021737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06376457214355469, "StateBufferConnector_ms": 0.0094451904296875, "ViewRequirementAgentConnector_ms": 0.20014286041259766}, "num_episodes": 0, "episode_return_max": 3901.0, "episode_return_min": -65.0, "episode_return_mean": 128.96, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 22000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.165690238517914, "num_env_steps_trained_throughput_per_sec": 613.3020876325733, "timesteps_total": 22000, "num_env_steps_sampled_lifetime": 22000, "num_agent_steps_sampled_lifetime": 22000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 22000, "timers": {"training_iteration_time_ms": 51420.524, "restore_workers_time_ms": 0.012, "training_step_time_ms": 52.54, "sample_time_ms": 22.078, "load_time_ms": 0.147, "load_throughput": 216970.139, "learn_time_ms": 13.53, "learn_throughput": 2365.149, "synch_weights_time_ms": 5.911}, "counters": {"num_env_steps_sampled": 22000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 672000, "last_target_update_ts": 21501, "num_target_updates": 42}, "done": false, "episodes_total": 181, "training_iteration": 22, "trial_id": "default", "date": "2024-05-20_23-02-52", "timestamp": 1716271372, "time_this_iter_s": 52.192116022109985, "time_total_s": 1076.2983980178833, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1076.2983980178833, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 64.00133333333332, "ram_util_percent": 54.72133333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0654296875, "mean_q": 44.2412223815918, "min_q": -35.777862548828125, "max_q": 78.51549530029297, "cur_lr": 0.0005}, "td_error": [0.15173721313476562, 8.644271850585938, 0.7098922729492188, -0.4805183410644531, -0.31116485595703125, -5.777862548828125, 0.4299354553222656, 0.6692047119140625, -3.696502685546875, 0.6288299560546875, 1.2365379333496094, 0.1338043212890625, 3.2455596923828125, -0.3579864501953125, -0.3757362365722656, 0.6692047119140625, 0.4681892395019531, -0.3579864501953125, 0.22927093505859375, 0.21554183959960938, 0.096405029296875, 0.23867416381835938, 3.689342498779297, 0.6304054260253906, 0.6678428649902344, 3.6657752990722656, 0.6817207336425781, 0.5767135620117188, -1.5556716918945312, 1.1588211059570312, 0.9370193481445312, 2.8761215209960938], "mean_td_error": 0.6167935132980347, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 22000.0, "diff_num_grad_updates_vs_sampler_policy": 21999.0}}, "num_env_steps_sampled": 23000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 704000, "last_target_update_ts": 22501, "num_target_updates": 44}, "sampler_results": {"episode_reward_max": 3901.0, "episode_reward_min": -65.0, "episode_reward_mean": 128.96, "episode_len_mean": 179.36, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 17936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0], "episode_lengths": [72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8752540079843465, "mean_inference_ms": 2.311990794608536, "mean_action_processing_ms": 0.10165674269999242, "mean_env_wait_ms": 0.22386160968021737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06376457214355469, "StateBufferConnector_ms": 0.0094451904296875, "ViewRequirementAgentConnector_ms": 0.20014286041259766}, "num_episodes": 0, "episode_return_max": 3901.0, "episode_return_min": -65.0, "episode_return_mean": 128.96}, "env_runner_results": {"episode_reward_max": 3901.0, "episode_reward_min": -65.0, "episode_reward_mean": 128.96, "episode_len_mean": 179.36, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 17936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0], "episode_lengths": [72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8752540079843465, "mean_inference_ms": 2.311990794608536, "mean_action_processing_ms": 0.10165674269999242, "mean_env_wait_ms": 0.22386160968021737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06376457214355469, "StateBufferConnector_ms": 0.0094451904296875, "ViewRequirementAgentConnector_ms": 0.20014286041259766}, "num_episodes": 0, "episode_return_max": 3901.0, "episode_return_min": -65.0, "episode_return_mean": 128.96}, "episode_reward_max": 3901.0, "episode_reward_min": -65.0, "episode_reward_mean": 128.96, "episode_len_mean": 179.36, "episodes_this_iter": 0, "episodes_timesteps_total": 17936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0], "episode_lengths": [72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8752540079843465, "mean_inference_ms": 2.311990794608536, "mean_action_processing_ms": 0.10165674269999242, "mean_env_wait_ms": 0.22386160968021737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06376457214355469, "StateBufferConnector_ms": 0.0094451904296875, "ViewRequirementAgentConnector_ms": 0.20014286041259766}, "num_episodes": 0, "episode_return_max": 3901.0, "episode_return_min": -65.0, "episode_return_mean": 128.96, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 23000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.335319800481706, "num_env_steps_trained_throughput_per_sec": 618.7302336154146, "timesteps_total": 23000, "num_env_steps_sampled_lifetime": 23000, "num_agent_steps_sampled_lifetime": 23000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 23000, "timers": {"training_iteration_time_ms": 51422.876, "restore_workers_time_ms": 0.008, "training_step_time_ms": 50.439, "sample_time_ms": 19.795, "load_time_ms": 0.162, "load_throughput": 197291.971, "learn_time_ms": 13.995, "learn_throughput": 2286.604, "synch_weights_time_ms": 5.745}, "counters": {"num_env_steps_sampled": 23000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 704000, "last_target_update_ts": 22501, "num_target_updates": 44}, "done": false, "episodes_total": 181, "training_iteration": 23, "trial_id": "default", "date": "2024-05-20_23-03-44", "timestamp": 1716271424, "time_this_iter_s": 51.73348689079285, "time_total_s": 1128.0318849086761, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1128.0318849086761, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 62.898630136986306, "ram_util_percent": 55.69863013698629}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4417589902877808, "mean_q": 52.05268859863281, "min_q": 34.525604248046875, "max_q": 76.53719329833984, "cur_lr": 0.0005}, "td_error": [0.3460350036621094, 0.3205909729003906, 1.9299163818359375, -0.39151763916015625, -4.4007110595703125, 1.9051628112792969, 2.0885772705078125, 0.1881561279296875, 0.12042617797851562, 0.5385208129882812, -0.9631500244140625, 1.0173568725585938, 0.1881561279296875, -1.7257881164550781, -0.3452033996582031, -0.26740264892578125, 0.119659423828125, 0.8196830749511719, 2.170909881591797, 0.4381256103515625, 0.622711181640625, 5.2933807373046875, 0.9554862976074219, -0.17206192016601562, 0.492706298828125, -0.8727874755859375, -0.2754325866699219, -2.4301300048828125, -0.3188591003417969, 0.7123947143554688, -0.6210746765136719, -0.31906890869140625], "mean_td_error": 0.2238990068435669, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 23000.0, "diff_num_grad_updates_vs_sampler_policy": 22999.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 736000, "last_target_update_ts": 23501, "num_target_updates": 46}, "sampler_results": {"episode_reward_max": 3901.0, "episode_reward_min": -65.0, "episode_reward_mean": 128.96, "episode_len_mean": 179.36, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 17936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0], "episode_lengths": [72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8752540079843465, "mean_inference_ms": 2.311990794608536, "mean_action_processing_ms": 0.10165674269999242, "mean_env_wait_ms": 0.22386160968021737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06376457214355469, "StateBufferConnector_ms": 0.0094451904296875, "ViewRequirementAgentConnector_ms": 0.20014286041259766}, "num_episodes": 0, "episode_return_max": 3901.0, "episode_return_min": -65.0, "episode_return_mean": 128.96}, "env_runner_results": {"episode_reward_max": 3901.0, "episode_reward_min": -65.0, "episode_reward_mean": 128.96, "episode_len_mean": 179.36, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 17936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0], "episode_lengths": [72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8752540079843465, "mean_inference_ms": 2.311990794608536, "mean_action_processing_ms": 0.10165674269999242, "mean_env_wait_ms": 0.22386160968021737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06376457214355469, "StateBufferConnector_ms": 0.0094451904296875, "ViewRequirementAgentConnector_ms": 0.20014286041259766}, "num_episodes": 0, "episode_return_max": 3901.0, "episode_return_min": -65.0, "episode_return_mean": 128.96}, "episode_reward_max": 3901.0, "episode_reward_min": -65.0, "episode_reward_mean": 128.96, "episode_len_mean": 179.36, "episodes_this_iter": 0, "episodes_timesteps_total": 17936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0], "episode_lengths": [72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8752540079843465, "mean_inference_ms": 2.311990794608536, "mean_action_processing_ms": 0.10165674269999242, "mean_env_wait_ms": 0.22386160968021737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06376457214355469, "StateBufferConnector_ms": 0.0094451904296875, "ViewRequirementAgentConnector_ms": 0.20014286041259766}, "num_episodes": 0, "episode_return_max": 3901.0, "episode_return_min": -65.0, "episode_return_mean": 128.96, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 20.037944740500528, "num_env_steps_trained_throughput_per_sec": 641.2142316960169, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 51391.544, "restore_workers_time_ms": 0.009, "training_step_time_ms": 46.557, "sample_time_ms": 18.373, "load_time_ms": 0.142, "load_throughput": 224782.663, "learn_time_ms": 12.633, "learn_throughput": 2532.988, "synch_weights_time_ms": 5.228}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 736000, "last_target_update_ts": 23501, "num_target_updates": 46}, "done": false, "episodes_total": 181, "training_iteration": 24, "trial_id": "default", "date": "2024-05-20_23-04-34", "timestamp": 1716271474, "time_this_iter_s": 49.92084288597107, "time_total_s": 1177.9527277946472, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1177.9527277946472, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 60.361971830985915, "ram_util_percent": 55.09014084507042}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8738672733306885, "mean_q": 52.179718017578125, "min_q": 40.750064849853516, "max_q": 71.7965316772461, "cur_lr": 0.0005}, "td_error": [-2.471099853515625, -0.05767822265625, -1.9530296325683594, -0.240264892578125, 0.17028427124023438, 0.4080657958984375, 3.5687942504882812, 5.588531494140625, 0.5494308471679688, -0.5785446166992188, -0.7246208190917969, -0.08928680419921875, -0.7730560302734375, 3.2333412170410156, 3.1331253051757812, -0.19877243041992188, 1.4070625305175781, 0.046504974365234375, 0.6965370178222656, -1.3647689819335938, -0.46971893310546875, -1.3647689819335938, -0.7246208190917969, -2.163410186767578, -0.0140838623046875, -1.8897933959960938, -0.7730560302734375, -1.1317138671875, 0.8309822082519531, 1.1546630859375, -0.0933990478515625, 0.2893791198730469], "mean_td_error": 0.1250317096710205, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 24000.0, "diff_num_grad_updates_vs_sampler_policy": 23999.0}}, "num_env_steps_sampled": 25000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 768000, "last_target_update_ts": 24501, "num_target_updates": 48}, "sampler_results": {"episode_reward_max": 3901.0, "episode_reward_min": -65.0, "episode_reward_mean": 128.96, "episode_len_mean": 179.36, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 17936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0], "episode_lengths": [72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8752540079843465, "mean_inference_ms": 2.311990794608536, "mean_action_processing_ms": 0.10165674269999242, "mean_env_wait_ms": 0.22386160968021737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06376457214355469, "StateBufferConnector_ms": 0.0094451904296875, "ViewRequirementAgentConnector_ms": 0.20014286041259766}, "num_episodes": 0, "episode_return_max": 3901.0, "episode_return_min": -65.0, "episode_return_mean": 128.96}, "env_runner_results": {"episode_reward_max": 3901.0, "episode_reward_min": -65.0, "episode_reward_mean": 128.96, "episode_len_mean": 179.36, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 17936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0], "episode_lengths": [72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8752540079843465, "mean_inference_ms": 2.311990794608536, "mean_action_processing_ms": 0.10165674269999242, "mean_env_wait_ms": 0.22386160968021737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06376457214355469, "StateBufferConnector_ms": 0.0094451904296875, "ViewRequirementAgentConnector_ms": 0.20014286041259766}, "num_episodes": 0, "episode_return_max": 3901.0, "episode_return_min": -65.0, "episode_return_mean": 128.96}, "episode_reward_max": 3901.0, "episode_reward_min": -65.0, "episode_reward_mean": 128.96, "episode_len_mean": 179.36, "episodes_this_iter": 0, "episodes_timesteps_total": 17936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-13.0, 24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0], "episode_lengths": [72, 7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8752540079843465, "mean_inference_ms": 2.311990794608536, "mean_action_processing_ms": 0.10165674269999242, "mean_env_wait_ms": 0.22386160968021737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06376457214355469, "StateBufferConnector_ms": 0.0094451904296875, "ViewRequirementAgentConnector_ms": 0.20014286041259766}, "num_episodes": 0, "episode_return_max": 3901.0, "episode_return_min": -65.0, "episode_return_mean": 128.96, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 25000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 20.535022731097452, "num_env_steps_trained_throughput_per_sec": 657.1207273951185, "timesteps_total": 25000, "num_env_steps_sampled_lifetime": 25000, "num_agent_steps_sampled_lifetime": 25000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 25000, "timers": {"training_iteration_time_ms": 50704.759, "restore_workers_time_ms": 0.008, "training_step_time_ms": 45.573, "sample_time_ms": 17.846, "load_time_ms": 0.138, "load_throughput": 231170.734, "learn_time_ms": 12.307, "learn_throughput": 2600.232, "synch_weights_time_ms": 5.208}, "counters": {"num_env_steps_sampled": 25000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 768000, "last_target_update_ts": 24501, "num_target_updates": 48}, "done": false, "episodes_total": 181, "training_iteration": 25, "trial_id": "default", "date": "2024-05-20_23-05-23", "timestamp": 1716271523, "time_this_iter_s": 48.71191716194153, "time_total_s": 1226.6646449565887, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1226.6646449565887, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 59.301449275362316, "ram_util_percent": 55.002898550724645}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6342858672142029, "mean_q": 50.47172927856445, "min_q": -18.219240188598633, "max_q": 87.45440673828125, "cur_lr": 0.0005}, "td_error": [-0.3313140869140625, -0.4769325256347656, 0.3468132019042969, 0.04280853271484375, 0.10908889770507812, -1.0537643432617188, 0.10908889770507812, 0.9173927307128906, 1.2412490844726562, -0.4983940124511719, -0.4713783264160156, -0.4713783264160156, 6.8409881591796875, -0.23417282104492188, 0.10908889770507812, 0.1865081787109375, -0.4741859436035156, -1.5788383483886719, 0.25554656982421875, 1.2405776977539062, -1.7397537231445312, -0.06818389892578125, 0.877227783203125, -1.8921928405761719, 0.8705940246582031, -0.9744949340820312, -0.7153053283691406, -0.23440170288085938, -0.3313140869140625, 0.39544677734375, 11.780759811401367, 20.018939971923828], "mean_td_error": 1.0561285018920898, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 25000.0, "diff_num_grad_updates_vs_sampler_policy": 24999.0}}, "num_env_steps_sampled": 26000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 800000, "last_target_update_ts": 25501, "num_target_updates": 50}, "sampler_results": {"episode_reward_max": 4935.0, "episode_reward_min": -65.0, "episode_reward_mean": 178.44, "episode_len_mean": 228.42, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 22842, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0, 4935.0], "episode_lengths": [7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998, 4978]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8760156081595205, "mean_inference_ms": 2.31266027266262, "mean_action_processing_ms": 0.10168960057994289, "mean_env_wait_ms": 0.22413716232271344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06390810012817383, "StateBufferConnector_ms": 0.00944972038269043, "ViewRequirementAgentConnector_ms": 0.20020031929016113}, "num_episodes": 1, "episode_return_max": 4935.0, "episode_return_min": -65.0, "episode_return_mean": 178.44}, "env_runner_results": {"episode_reward_max": 4935.0, "episode_reward_min": -65.0, "episode_reward_mean": 178.44, "episode_len_mean": 228.42, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 22842, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0, 4935.0], "episode_lengths": [7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998, 4978]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8760156081595205, "mean_inference_ms": 2.31266027266262, "mean_action_processing_ms": 0.10168960057994289, "mean_env_wait_ms": 0.22413716232271344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06390810012817383, "StateBufferConnector_ms": 0.00944972038269043, "ViewRequirementAgentConnector_ms": 0.20020031929016113}, "num_episodes": 1, "episode_return_max": 4935.0, "episode_return_min": -65.0, "episode_return_mean": 178.44}, "episode_reward_max": 4935.0, "episode_reward_min": -65.0, "episode_reward_mean": 178.44, "episode_len_mean": 228.42, "episodes_this_iter": 1, "episodes_timesteps_total": 22842, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.0, -65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0, 4935.0], "episode_lengths": [7, 38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998, 4978]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8760156081595205, "mean_inference_ms": 2.31266027266262, "mean_action_processing_ms": 0.10168960057994289, "mean_env_wait_ms": 0.22413716232271344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06390810012817383, "StateBufferConnector_ms": 0.00944972038269043, "ViewRequirementAgentConnector_ms": 0.20020031929016113}, "num_episodes": 1, "episode_return_max": 4935.0, "episode_return_min": -65.0, "episode_return_mean": 178.44, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 26000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 21.606150657320004, "num_env_steps_trained_throughput_per_sec": 691.3968210342401, "timesteps_total": 26000, "num_env_steps_sampled_lifetime": 26000, "num_agent_steps_sampled_lifetime": 26000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 26000, "timers": {"training_iteration_time_ms": 50226.918, "restore_workers_time_ms": 0.009, "training_step_time_ms": 50.699, "sample_time_ms": 19.763, "load_time_ms": 0.153, "load_throughput": 209355.37, "learn_time_ms": 14.457, "learn_throughput": 2213.51, "synch_weights_time_ms": 5.499}, "counters": {"num_env_steps_sampled": 26000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 800000, "last_target_update_ts": 25501, "num_target_updates": 50}, "done": false, "episodes_total": 182, "training_iteration": 26, "trial_id": "default", "date": "2024-05-20_23-06-09", "timestamp": 1716271569, "time_this_iter_s": 46.29760718345642, "time_total_s": 1272.9622521400452, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1272.9622521400452, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 55.97424242424242, "ram_util_percent": 54.40454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1155195236206055, "mean_q": 53.95033264160156, "min_q": -23.725099563598633, "max_q": 87.2496109008789, "cur_lr": 0.0005}, "td_error": [1.7941055297851562, -0.3446044921875, -1.0667190551757812, 0.3847999572753906, -0.5654296875, -0.3270263671875, 0.10391616821289062, 0.10107040405273438, -3.1263198852539062, -1.310760498046875, -2.1580734252929688, -0.6689987182617188, 4.101707458496094, -0.5654296875, -2.6738967895507812, -1.353515625, -0.19228744506835938, 1.4659805297851562, -0.31421661376953125, -0.6689987182617188, 0.6699752807617188, -1.0417671203613281, -0.6689987182617188, -1.0897712707519531, -0.09864044189453125, -1.7424240112304688, 0.9601058959960938, 6.274900436401367, 0.27278900146484375, 0.7580299377441406, -0.063720703125, -1.6629867553710938], "mean_td_error": -0.1505376696586609, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 26000.0, "diff_num_grad_updates_vs_sampler_policy": 25999.0}}, "num_env_steps_sampled": 27000, "num_env_steps_trained": 832000, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 832000, "last_target_update_ts": 26501, "num_target_updates": 52}, "sampler_results": {"episode_reward_max": 4935.0, "episode_reward_min": -65.0, "episode_reward_mean": 186.69, "episode_len_mean": 237.27, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 23727, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0, 4935.0, 849.0], "episode_lengths": [38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998, 4978, 892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8767701109618329, "mean_inference_ms": 2.3133129203518568, "mean_action_processing_ms": 0.10172160967343849, "mean_env_wait_ms": 0.22441289644086904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0639803409576416, "StateBufferConnector_ms": 0.009425878524780273, "ViewRequirementAgentConnector_ms": 0.200300931930542}, "num_episodes": 1, "episode_return_max": 4935.0, "episode_return_min": -65.0, "episode_return_mean": 186.69}, "env_runner_results": {"episode_reward_max": 4935.0, "episode_reward_min": -65.0, "episode_reward_mean": 186.69, "episode_len_mean": 237.27, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 23727, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0, 4935.0, 849.0], "episode_lengths": [38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998, 4978, 892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8767701109618329, "mean_inference_ms": 2.3133129203518568, "mean_action_processing_ms": 0.10172160967343849, "mean_env_wait_ms": 0.22441289644086904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0639803409576416, "StateBufferConnector_ms": 0.009425878524780273, "ViewRequirementAgentConnector_ms": 0.200300931930542}, "num_episodes": 1, "episode_return_max": 4935.0, "episode_return_min": -65.0, "episode_return_mean": 186.69}, "episode_reward_max": 4935.0, "episode_reward_min": -65.0, "episode_reward_mean": 186.69, "episode_len_mean": 237.27, "episodes_this_iter": 1, "episodes_timesteps_total": 23727, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0, 4935.0, 849.0], "episode_lengths": [38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998, 4978, 892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8767701109618329, "mean_inference_ms": 2.3133129203518568, "mean_action_processing_ms": 0.10172160967343849, "mean_env_wait_ms": 0.22441289644086904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0639803409576416, "StateBufferConnector_ms": 0.009425878524780273, "ViewRequirementAgentConnector_ms": 0.200300931930542}, "num_episodes": 1, "episode_return_max": 4935.0, "episode_return_min": -65.0, "episode_return_mean": 186.69, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 27000, "num_env_steps_trained": 832000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.921269667087657, "num_env_steps_trained_throughput_per_sec": 637.480629346805, "timesteps_total": 27000, "num_env_steps_sampled_lifetime": 27000, "num_agent_steps_sampled_lifetime": 27000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 27000, "timers": {"training_iteration_time_ms": 50264.163, "restore_workers_time_ms": 0.008, "training_step_time_ms": 47.001, "sample_time_ms": 18.697, "load_time_ms": 0.151, "load_throughput": 212504.319, "learn_time_ms": 12.631, "learn_throughput": 2533.409, "synch_weights_time_ms": 5.379}, "counters": {"num_env_steps_sampled": 27000, "num_env_steps_trained": 832000, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 832000, "last_target_update_ts": 26501, "num_target_updates": 52}, "done": false, "episodes_total": 183, "training_iteration": 27, "trial_id": "default", "date": "2024-05-20_23-06-59", "timestamp": 1716271619, "time_this_iter_s": 50.213956117630005, "time_total_s": 1323.1762082576752, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1323.1762082576752, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 61.104166666666664, "ram_util_percent": 55.25555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7124726176261902, "mean_q": 59.54779052734375, "min_q": 42.07100296020508, "max_q": 93.52242279052734, "cur_lr": 0.0005}, "td_error": [0.14558029174804688, -0.24488067626953125, 0.4782066345214844, 0.7673568725585938, -0.2301025390625, -1.4238815307617188, -0.6688957214355469, -1.2982215881347656, 0.027469635009765625, -0.905242919921875, 1.4608917236328125, -0.01032257080078125, -0.6384925842285156, 0.056804656982421875, -0.435943603515625, -0.5182991027832031, 0.2617149353027344, 1.1941299438476562, 0.15187835693359375, 1.8414688110351562, -1.3546905517578125, -0.9880447387695312, -0.5653762817382812, 0.14558029174804688, 0.421478271484375, 0.028594970703125, 0.6600418090820312, 0.8775405883789062, 0.7673568725585938, 2.8465194702148438, -1.6493759155273438, 0.5738601684570312], "mean_td_error": 0.05545949935913086, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 27000.0, "diff_num_grad_updates_vs_sampler_policy": 26999.0}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 864000, "last_target_update_ts": 27501, "num_target_updates": 54}, "sampler_results": {"episode_reward_max": 4935.0, "episode_reward_min": -65.0, "episode_reward_mean": 186.69, "episode_len_mean": 237.27, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 23727, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0, 4935.0, 849.0], "episode_lengths": [38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998, 4978, 892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8767701109618329, "mean_inference_ms": 2.3133129203518568, "mean_action_processing_ms": 0.10172160967343849, "mean_env_wait_ms": 0.22441289644086904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0639803409576416, "StateBufferConnector_ms": 0.009425878524780273, "ViewRequirementAgentConnector_ms": 0.200300931930542}, "num_episodes": 0, "episode_return_max": 4935.0, "episode_return_min": -65.0, "episode_return_mean": 186.69}, "env_runner_results": {"episode_reward_max": 4935.0, "episode_reward_min": -65.0, "episode_reward_mean": 186.69, "episode_len_mean": 237.27, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 23727, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0, 4935.0, 849.0], "episode_lengths": [38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998, 4978, 892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8767701109618329, "mean_inference_ms": 2.3133129203518568, "mean_action_processing_ms": 0.10172160967343849, "mean_env_wait_ms": 0.22441289644086904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0639803409576416, "StateBufferConnector_ms": 0.009425878524780273, "ViewRequirementAgentConnector_ms": 0.200300931930542}, "num_episodes": 0, "episode_return_max": 4935.0, "episode_return_min": -65.0, "episode_return_mean": 186.69}, "episode_reward_max": 4935.0, "episode_reward_min": -65.0, "episode_reward_mean": 186.69, "episode_len_mean": 237.27, "episodes_this_iter": 0, "episodes_timesteps_total": 23727, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-65.0, -22.0, 17.0, -34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0, 4935.0, 849.0], "episode_lengths": [38, 27, 16, 15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998, 4978, 892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8767701109618329, "mean_inference_ms": 2.3133129203518568, "mean_action_processing_ms": 0.10172160967343849, "mean_env_wait_ms": 0.22441289644086904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0639803409576416, "StateBufferConnector_ms": 0.009425878524780273, "ViewRequirementAgentConnector_ms": 0.200300931930542}, "num_episodes": 0, "episode_return_max": 4935.0, "episode_return_min": -65.0, "episode_return_mean": 186.69, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.91459744868245, "num_env_steps_trained_throughput_per_sec": 637.2671183578384, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 50275.453, "restore_workers_time_ms": 0.01, "training_step_time_ms": 49.459, "sample_time_ms": 19.192, "load_time_ms": 0.161, "load_throughput": 198282.949, "learn_time_ms": 13.79, "learn_throughput": 2320.452, "synch_weights_time_ms": 5.736}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 864000, "last_target_update_ts": 27501, "num_target_updates": 54}, "done": false, "episodes_total": 183, "training_iteration": 28, "trial_id": "default", "date": "2024-05-20_23-07-50", "timestamp": 1716271670, "time_this_iter_s": 50.233633041381836, "time_total_s": 1373.409841299057, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1373.409841299057, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 61.64929577464788, "ram_util_percent": 54.83521126760565}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.220933198928833, "mean_q": 56.27525329589844, "min_q": -39.191314697265625, "max_q": 100.0609130859375, "cur_lr": 0.0005}, "td_error": [1.7888565063476562, 0.6651763916015625, 0.7121696472167969, -0.32894134521484375, 0.23482894897460938, 0.5472946166992188, -2.1518478393554688, 2.009654998779297, 3.2349891662597656, 0.1688995361328125, 0.9540061950683594, 3.2349891662597656, 0.34342193603515625, -0.8071136474609375, 1.3580741882324219, -2.26318359375, 0.9540061950683594, -2.3538436889648438, 0.3928947448730469, -0.19810104370117188, -0.7363128662109375, -1.2204437255859375, -1.98828125, 0.34342193603515625, -9.191314697265625, 1.6138343811035156, -0.32190704345703125, -55.3868293762207, 0.22788619995117188, -0.12686920166015625, -0.3040504455566406, -1.9882774353027344], "mean_td_error": -1.8932160139083862, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 28000.0, "diff_num_grad_updates_vs_sampler_policy": 27999.0}}, "num_env_steps_sampled": 29000, "num_env_steps_trained": 896000, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 896000, "last_target_update_ts": 28501, "num_target_updates": 56}, "sampler_results": {"episode_reward_max": 4935.0, "episode_reward_min": -85.0, "episode_reward_mean": 202.78, "episode_len_mean": 253.66, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 25366, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0, 4935.0, 849.0, 1454.0, 170.0, -85.0], "episode_lengths": [15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998, 4978, 892, 1527, 77, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8790474331053386, "mean_inference_ms": 2.3151667376665923, "mean_action_processing_ms": 0.10181591618988874, "mean_env_wait_ms": 0.2252390378377085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06430363655090332, "StateBufferConnector_ms": 0.009422540664672852, "ViewRequirementAgentConnector_ms": 0.20041990280151367}, "num_episodes": 3, "episode_return_max": 4935.0, "episode_return_min": -85.0, "episode_return_mean": 202.78}, "env_runner_results": {"episode_reward_max": 4935.0, "episode_reward_min": -85.0, "episode_reward_mean": 202.78, "episode_len_mean": 253.66, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 25366, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0, 4935.0, 849.0, 1454.0, 170.0, -85.0], "episode_lengths": [15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998, 4978, 892, 1527, 77, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8790474331053386, "mean_inference_ms": 2.3151667376665923, "mean_action_processing_ms": 0.10181591618988874, "mean_env_wait_ms": 0.2252390378377085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06430363655090332, "StateBufferConnector_ms": 0.009422540664672852, "ViewRequirementAgentConnector_ms": 0.20041990280151367}, "num_episodes": 3, "episode_return_max": 4935.0, "episode_return_min": -85.0, "episode_return_mean": 202.78}, "episode_reward_max": 4935.0, "episode_reward_min": -85.0, "episode_reward_mean": 202.78, "episode_len_mean": 253.66, "episodes_this_iter": 3, "episodes_timesteps_total": 25366, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, -9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0, 4935.0, 849.0, 1454.0, 170.0, -85.0], "episode_lengths": [15, 46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998, 4978, 892, 1527, 77, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8790474331053386, "mean_inference_ms": 2.3151667376665923, "mean_action_processing_ms": 0.10181591618988874, "mean_env_wait_ms": 0.2252390378377085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06430363655090332, "StateBufferConnector_ms": 0.009422540664672852, "ViewRequirementAgentConnector_ms": 0.20041990280151367}, "num_episodes": 3, "episode_return_max": 4935.0, "episode_return_min": -85.0, "episode_return_mean": 202.78, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 29000, "num_env_steps_trained": 896000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 20.240231724494375, "num_env_steps_trained_throughput_per_sec": 647.68741518382, "timesteps_total": 29000, "num_env_steps_sampled_lifetime": 29000, "num_agent_steps_sampled_lifetime": 29000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 29000, "timers": {"training_iteration_time_ms": 49886.903, "restore_workers_time_ms": 0.011, "training_step_time_ms": 50.045, "sample_time_ms": 19.799, "load_time_ms": 0.155, "load_throughput": 205918.576, "learn_time_ms": 13.761, "learn_throughput": 2325.425, "synch_weights_time_ms": 5.618}, "counters": {"num_env_steps_sampled": 29000, "num_env_steps_trained": 896000, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 896000, "last_target_update_ts": 28501, "num_target_updates": 56}, "done": false, "episodes_total": 186, "training_iteration": 29, "trial_id": "default", "date": "2024-05-20_23-08-39", "timestamp": 1716271719, "time_this_iter_s": 49.421557903289795, "time_total_s": 1422.8313992023468, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1422.8313992023468, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 60.432857142857145, "ram_util_percent": 53.90857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6478059887886047, "mean_q": 62.1424560546875, "min_q": -37.351192474365234, "max_q": 91.14991760253906, "cur_lr": 0.0005}, "td_error": [0.8712997436523438, 0.5312957763671875, 0.08190155029296875, -0.01554107666015625, -0.2586936950683594, -0.5110397338867188, -0.5642471313476562, -0.22798919677734375, 0.2697868347167969, 0.7676849365234375, -0.0729827880859375, -0.305419921875, -0.9630584716796875, -0.06386566162109375, 0.4799346923828125, 0.5312957763671875, -0.003215789794921875, -0.17891311645507812, -0.21971893310546875, -0.2076263427734375, 0.44171905517578125, 0.69293212890625, -7.351192474365234, -0.45864105224609375, 1.5823135375976562, -0.4992179870605469, 0.022609710693359375, 0.08190155029296875, -0.3041343688964844, -0.02062225341796875, 0.2697792053222656, 0.62939453125], "mean_td_error": -0.15538346767425537, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 29000.0, "diff_num_grad_updates_vs_sampler_policy": 28999.0}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 928000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 928000, "last_target_update_ts": 29501, "num_target_updates": 58}, "sampler_results": {"episode_reward_max": 4935.0, "episode_reward_min": -85.0, "episode_reward_mean": 220.09, "episode_len_mean": 269.61, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 26961, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0, 4935.0, 849.0, 1454.0, 170.0, -85.0, 1697.0], "episode_lengths": [46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998, 4978, 892, 1527, 77, 116, 1610]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8798026504610498, "mean_inference_ms": 2.315775736725894, "mean_action_processing_ms": 0.10184673222876267, "mean_env_wait_ms": 0.22551396559612974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06435084342956543, "StateBufferConnector_ms": 0.009427309036254883, "ViewRequirementAgentConnector_ms": 0.2005009651184082}, "num_episodes": 1, "episode_return_max": 4935.0, "episode_return_min": -85.0, "episode_return_mean": 220.09}, "env_runner_results": {"episode_reward_max": 4935.0, "episode_reward_min": -85.0, "episode_reward_mean": 220.09, "episode_len_mean": 269.61, "episode_media": {}, "episodes_this_iter": 1, "episodes_timesteps_total": 26961, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0, 4935.0, 849.0, 1454.0, 170.0, -85.0, 1697.0], "episode_lengths": [46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998, 4978, 892, 1527, 77, 116, 1610]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8798026504610498, "mean_inference_ms": 2.315775736725894, "mean_action_processing_ms": 0.10184673222876267, "mean_env_wait_ms": 0.22551396559612974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06435084342956543, "StateBufferConnector_ms": 0.009427309036254883, "ViewRequirementAgentConnector_ms": 0.2005009651184082}, "num_episodes": 1, "episode_return_max": 4935.0, "episode_return_min": -85.0, "episode_return_mean": 220.09}, "episode_reward_max": 4935.0, "episode_reward_min": -85.0, "episode_reward_mean": 220.09, "episode_len_mean": 269.61, "episodes_this_iter": 1, "episodes_timesteps_total": 26961, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.0, 39.0, -15.0, -40.0, -24.0, -29.0, 60.0, 13.0, -60.0, 10.0, 14.0, 53.0, -40.0, 17.0, 22.0, -46.0, -51.0, -21.0, -65.0, 27.0, 8.0, 17.0, 12.0, -28.0, -51.0, -17.0, 23.0, -23.0, 27.0, -32.0, -11.0, -25.0, -36.0, -42.0, 34.0, -24.0, -21.0, -33.0, 50.0, -28.0, 33.0, 16.0, 53.0, -9.0, -56.0, -35.0, 8.0, 57.0, -36.0, 44.0, 70.0, 18.0, 5.0, 32.0, 22.0, -28.0, 46.0, -28.0, 62.0, 74.0, 19.0, -33.0, -33.0, -24.0, 28.0, 32.0, 30.0, 56.0, -10.0, 11.0, 10.0, -25.0, 325.0, -33.0, -43.0, 99.0, 27.0, 79.0, -26.0, 105.0, -8.0, 43.0, 290.0, 588.0, 42.0, 224.0, 121.0, 362.0, 2272.0, 114.0, 2653.0, 684.0, 1106.0, 3901.0, 4935.0, 849.0, 1454.0, 170.0, -85.0, 1697.0], "episode_lengths": [46, 136, 46, 27, 13, 44, 17, 38, 55, 23, 13, 60, 9, 6, 125, 33, 58, 22, 98, 22, 147, 6, 43, 21, 40, 32, 114, 14, 4, 41, 50, 12, 19, 55, 17, 19, 40, 10, 19, 9, 22, 89, 42, 34, 29, 92, 21, 28, 13, 213, 203, 79, 18, 15, 11, 21, 23, 15, 25, 37, 98, 16, 4, 115, 5, 27, 181, 13, 21, 60, 59, 24, 404, 4, 6, 86, 4, 50, 11, 94, 23, 86, 447, 661, 13, 309, 188, 439, 2287, 151, 2828, 787, 1629, 3998, 4978, 892, 1527, 77, 116, 1610]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8798026504610498, "mean_inference_ms": 2.315775736725894, "mean_action_processing_ms": 0.10184673222876267, "mean_env_wait_ms": 0.22551396559612974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06435084342956543, "StateBufferConnector_ms": 0.009427309036254883, "ViewRequirementAgentConnector_ms": 0.2005009651184082}, "num_episodes": 1, "episode_return_max": 4935.0, "episode_return_min": -85.0, "episode_return_mean": 220.09, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 30000, "num_env_steps_trained": 928000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.958864022468113, "num_env_steps_trained_throughput_per_sec": 638.6836487189796, "timesteps_total": 30000, "num_env_steps_sampled_lifetime": 30000, "num_agent_steps_sampled_lifetime": 30000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 49838.612, "restore_workers_time_ms": 0.008, "training_step_time_ms": 55.525, "sample_time_ms": 20.646, "load_time_ms": 0.197, "load_throughput": 162806.56, "learn_time_ms": 15.645, "learn_throughput": 2045.394, "synch_weights_time_ms": 5.791}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 928000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 928000, "last_target_update_ts": 29501, "num_target_updates": 58}, "done": false, "episodes_total": 187, "training_iteration": 30, "trial_id": "default", "date": "2024-05-20_23-09-29", "timestamp": 1716271769, "time_this_iter_s": 50.123039960861206, "time_total_s": 1472.954439163208, "pid": 3843, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "MyGrid", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ad84180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1472.954439163208, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 60.11527777777777, "ram_util_percent": 54.83888888888888}}
